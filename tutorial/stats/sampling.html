
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Universal Non-Uniform Random Number Sampling in SciPy &#8212; SciPy v1.15.0.dev Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyterlite_sphinx.css?v=ca70e7f1" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css?v=6dd54bfa" />
    <link rel="stylesheet" type="text/css" href="../../_static/try_examples.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=3d29109c"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=fe3c738c"></script>
    <script src="../../_static/jupyterlite_sphinx.js?v=d6bdf5f8"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script data-domain="docs.scipy.org" defer="defer" src="https://views.scientific-python.org/js/script.js"></script>
    <script async="async" src="../../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/stats/sampling';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scipy.github.io/devdocs/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'development';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Transformed Density Rejection (TDR)" href="sampling_tdr.html" />
    <link rel="prev" title="Yule-Simon Distribution" href="discrete_yulesimon.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.15.0.dev" />
    <meta name="docbuild:last-update" content="Oct 24, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt=""/>
    <img src="../../_static/logo.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">SciPy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipy.org/install/">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../building/index.html">
    Building from source
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipy/scipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/SciPy_team" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipy.org/install/">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../building/index.html">
    Building from source
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipy/scipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/SciPy_team" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links" aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav">
    <p aria-level="2" class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../special.html">Special functions (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrate.html">Integration (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize.html">Optimization (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpolate.html">Interpolation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fft.html">Fourier Transforms (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal.html">Signal Processing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linalg.html">Linear Algebra (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparse.html">Sparse Arrays (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arpack.html">Sparse eigenvalue problems with ARPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csgraph.html">Compressed Sparse Graph Routines (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csgraph</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spatial.html">Spatial data structures and algorithms (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.spatial</span></code>)</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../stats.html">Statistics (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats</span></code>)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="probability_distributions.html">Probability distributions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Universal Non-Uniform Random Number Sampling in SciPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel_density_estimation.html">Kernel density estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiscale_graphcorr.html">Multiscale Graph Correlation (MGC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quasi_monte_carlo.html">Quasi-Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysing_one_sample.html">Analysing one sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="comparing_two_samples.html">Comparing two samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling.html">Resampling and Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="hypothesis_tests.html">Hypothesis tests</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../ndimage.html">Multidimensional image processing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.ndimage</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">File IO (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code>)</a></li>
</ul>

  </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">SciPy User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="../stats.html" class="nav-link">Statistics (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats</span></code>)</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Universal Non-Uniform Random Number Sampling in SciPy</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <button class="try_examples_button" onclick="window.open('../../lite/lab/?path=sampling.ipynb')">Open as a notebook</button><section id="universal-non-uniform-random-number-sampling-in-scipy">
<span id="non-uniform-random-number-sampling"></span><h1>Universal Non-Uniform Random Number Sampling in SciPy<a class="headerlink" href="#universal-non-uniform-random-number-sampling-in-scipy" title="Link to this heading">#</a></h1>
<p>SciPy provides an interface to many universal non-uniform random number
generators to sample random variates from a wide variety of univariate
continuous and discrete distributions. Implementations of a fast C library
called <a class="reference external" href="http://statmath.wu.ac.at/software/unuran/">UNU.RAN</a> are used
for speed and performance. Please look at <a class="reference external" href="http://statmath.wu.ac.at/software/unuran/doc/unuran.html">UNU.RAN’s
documentation</a>
for an in-depth explanation of these methods. It is heavily referred to
for writing this tutorial and the documentation of all the generators.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>Random variate generation is the small field of research that deals with
algorithms to generate random variates from various distributions. It is
common to assume that a uniform random number generator is available.
This is a program that produces a sequence of independent and identically
distributed continuous U(0,1) random variates (i.e. uniform random variates
on the interval (0,1)). Of course, real-world computers can never generate
ideal random numbers and they cannot produce numbers of arbitrary precision
but state-of-the-art uniform random number generators come close to this
aim. Thus random variate generation deals with the problem of transforming
such a sequence of U(0,1) random numbers into non-uniform random variates.
These methods are universal and work in a black-box fashion.</p>
<p>Some methods to do that are:</p>
<ul class="simple">
<li><p>The Inversion method: When the inverse <span class="math notranslate nohighlight">\(F^{-1}\)</span> of the cumulative
distribution function is known, then random variate generation is easy.
We just generate a uniformly U(0,1) distributed random number U and
return <span class="math notranslate nohighlight">\(X = F^{-1}(U)\)</span>. As closed form solutions for the inverse
are rarely available, one usually needs to rely on approximations of
the inverse (e.g. <a class="reference internal" href="../../reference/generated/scipy.special.ndtri.html#scipy.special.ndtri" title="scipy.special.ndtri"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.special.ndtri</span></code></a>,
<a class="reference internal" href="../../reference/generated/scipy.special.stdtrit.html#scipy.special.stdtrit" title="scipy.special.stdtrit"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.special.stdtrit</span></code></a>). In general, the implementation of special
functions is quite slow compared to the inversion methods in UNU.RAN.</p></li>
<li><p>The Rejection Method: The rejection method, often called
acceptance-rejection method, has been suggested by John von Neumann in
1951<a class="footnote-reference brackets" href="#id4" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. It involves computing an upper bound to the PDF (also called the
hat function) and using the inversion method to generate a random
variate, say Y, from this bound. Then a uniform random number can be
drawn between 0 to the value of the upper bound at Y. If this number
is less than the PDF at Y, return the sample otherwise reject it. See
<a class="reference internal" href="../../reference/generated/scipy.stats.sampling.TransformedDensityRejection.html#scipy.stats.sampling.TransformedDensityRejection" title="scipy.stats.sampling.TransformedDensityRejection"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.TransformedDensityRejection</span></code></a>.</p></li>
<li><p>The Ratio-of-Uniforms Method: This is a type of acceptance-rejection
method which is uses minimal bounding rectangles to construct the hat
function. See <a class="reference internal" href="../../reference/generated/scipy.stats.sampling.RatioUniforms.html#scipy.stats.sampling.RatioUniforms" title="scipy.stats.sampling.RatioUniforms"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.RatioUniforms</span></code></a>.</p></li>
<li><p>Inversion for Discrete Distributions: The difference compared to the
continuous case is that <span class="math notranslate nohighlight">\(F\)</span> is now a step-function. To realize
this in a computer, a search algorithm is used, the simplest of which
is <em>sequential search</em>. A uniform random number is generated from
U(0, 1) and probabilities are summed until the cumulative probability
exceeds the uniform random number. The index at which this happens is
the required random variate and is returned.</p></li>
</ul>
<p>More details on these algorithms can be found in the <a class="reference external" href="http://statmath.wu.ac.at/software/unuran/doc/unuran.html#RVG">appendix of the UNU.RAN
user manual</a>.</p>
<p>When generating random variates of a distribution, two factors are important
to determine the speed of a generator: the setup step and the actual sampling.
Depending on the situation, different generators can be optimal. For example,
if one repeatedly needs to draw large samples from a given distribution with
a fixed shape parameter, a slow setup is acceptable if the sampling is fast.
This is called the fixed parameter case. If one aims to generate samples of
a distribution for different shape parameters (the varying parameter case),
an expensive setup that needs to be repeated for each parameter would lead
to very poor performance. In such a situation, a fast setup is crucial to
achieve good performance. An overview of the setup and sampling speed of the
different methods is shown in the table below.</p>
<div class="pst-scrollable-table-container"><table class="table" id="unuran-methods-summary">
<thead>
<tr class="row-odd"><th class="head"><p>Methods for continuous distributions</p></th>
<th class="head"><p>Required Inputs</p></th>
<th class="head"><p>Optional Inputs</p></th>
<th class="head"><p>Setup Speed</p></th>
<th class="head"><p>Sampling Speed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../reference/generated/scipy.stats.sampling.TransformedDensityRejection.html#scipy.stats.sampling.TransformedDensityRejection" title="scipy.stats.sampling.TransformedDensityRejection"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedDensityRejection</span></code></a></p></td>
<td><p>pdf, dpdf</p></td>
<td><p>none</p></td>
<td><p>slow</p></td>
<td><p>fast</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../reference/generated/scipy.stats.sampling.NumericalInverseHermite.html#scipy.stats.sampling.NumericalInverseHermite" title="scipy.stats.sampling.NumericalInverseHermite"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.NumericalInverseHermite</span></code></a></p></td>
<td><p>cdf</p></td>
<td><p>pdf, dpdf</p></td>
<td><p>(very) slow</p></td>
<td><p>(very) fast</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../reference/generated/scipy.stats.sampling.NumericalInversePolynomial.html#scipy.stats.sampling.NumericalInversePolynomial" title="scipy.stats.sampling.NumericalInversePolynomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.NumericalInversePolynomial</span></code></a></p></td>
<td><p>pdf</p></td>
<td><p>cdf</p></td>
<td><p>(very) slow</p></td>
<td><p>(very) fast</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../reference/generated/scipy.stats.sampling.SimpleRatioUniforms.html#scipy.stats.sampling.SimpleRatioUniforms" title="scipy.stats.sampling.SimpleRatioUniforms"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.SimpleRatioUniforms</span></code></a></p></td>
<td><p>pdf</p></td>
<td><p>none</p></td>
<td><p>fast</p></td>
<td><p>slow</p></td>
</tr>
</tbody>
</table>
</div>
<p>where</p>
<ul class="simple">
<li><p>pdf: probability density function</p></li>
<li><p>dpdf: derivative of the pdf</p></li>
<li><p>cdf: cumulative distribution function</p></li>
</ul>
<p>To apply the numerical inversion method NumericalInversePolynomial to a large
number of continuous distributions in SciPy with minimal effort, take a look
at <a class="reference internal" href="../../reference/generated/scipy.stats.sampling.FastGeneratorInversion.html#scipy.stats.sampling.FastGeneratorInversion" title="scipy.stats.sampling.FastGeneratorInversion"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.FastGeneratorInversion</span></code></a>.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Methods for discrete distributions</p></th>
<th class="head"><p>Required Inputs</p></th>
<th class="head"><p>Optional Inputs</p></th>
<th class="head"><p>Setup Speed</p></th>
<th class="head"><p>Sampling Speed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../reference/generated/scipy.stats.sampling.DiscreteAliasUrn.html#scipy.stats.sampling.DiscreteAliasUrn" title="scipy.stats.sampling.DiscreteAliasUrn"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.DiscreteAliasUrn</span></code></a></p></td>
<td><p>pv</p></td>
<td><p>pmf</p></td>
<td><p>slow</p></td>
<td><p>very fast</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../reference/generated/scipy.stats.sampling.DiscreteGuideTable.html#scipy.stats.sampling.DiscreteGuideTable" title="scipy.stats.sampling.DiscreteGuideTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.DiscreteGuideTable</span></code></a></p></td>
<td><p>pv</p></td>
<td><p>pmf</p></td>
<td><p>slow</p></td>
<td><p>very fast</p></td>
</tr>
</tbody>
</table>
</div>
<p>where</p>
<ul class="simple">
<li><p>pv: probability vector</p></li>
<li><p>pmf: probability mass function</p></li>
</ul>
<p>For more details on the generators implemented in UNU.RAN, please refer to <a class="footnote-reference brackets" href="#id5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#id6" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="basic-concepts-of-the-interface">
<h2>Basic concepts of the Interface<a class="headerlink" href="#basic-concepts-of-the-interface" title="Link to this heading">#</a></h2>
<p>Every generator needs to be set up before one can start sampling from it.
This can be done by instantiating an object of that class. Most of the
generators take a distribution object as input which contains the implementation
of required methods like PDF, CDF, etc. In addition to the distribution
object, one can also pass parameters used to set up the generator. It is also
possible to truncate the distributions using a <code class="docutils literal notranslate"><span class="pre">domain</span></code> parameter.  All
generators need a stream of uniform random numbers that are transformed into
random variates of the given distribution. This is done by passing a <code class="docutils literal notranslate"><span class="pre">random_state</span></code>
parameter with a NumPy BitGenerator as the uniform random number generator.
<code class="docutils literal notranslate"><span class="pre">random_state</span></code> can either be a integer, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.Generator" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code></a>,
or <a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use of NumPy &lt; 1.19.0 is discouraged as it doesn’t have a fast
Cython API for generating uniform random numbers and might be
too slow for practical use.</p>
</div>
<p>All the generators have a common <code class="docutils literal notranslate"><span class="pre">rvs</span></code> method that can be used to draw
samples from the given distribution.</p>
<p>An example of this interface is shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.sampling</span> <span class="kn">import</span> <span class="n">TransformedDensityRejection</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">StandardNormal</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># note that the normalization constant isn&#39;t required</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">dpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">StandardNormal</span><span class="p">()</span>
<span class="n">urng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">TransformedDensityRejection</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">urng</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As shown in the example, we first initialize a distribution object that
contains an implementation of the methods required by the generator. In
our case, we use the <a class="reference internal" href="../../reference/generated/scipy.stats.sampling.TransformedDensityRejection.html#scipy.stats.sampling.TransformedDensityRejection" title="scipy.stats.sampling.TransformedDensityRejection"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedDensityRejection</span></code></a> (TDR)
method which requires a PDF and its derivative w.r.t. <code class="docutils literal notranslate"><span class="pre">x</span></code> (i.e. the variate).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the methods of the distribution (i.e. <code class="docutils literal notranslate"><span class="pre">pdf</span></code>, <code class="docutils literal notranslate"><span class="pre">dpdf</span></code>, etc) need not
be vectorized. They should accept and return floats.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One can also pass the SciPy distributions as arguments. However, note that the
object doesn’t always have all the information required by some generators
like the derivative of PDF for the TDR method. Relying on SciPy distributions
might also reduce performance due to the vectorization of the methods like
<code class="docutils literal notranslate"><span class="pre">pdf</span></code> and <code class="docutils literal notranslate"><span class="pre">cdf</span></code>. In both cases, one can implement a custom distribution object
that contains all the required methods and that is not vectorized as shown in
the example above. If one wants to apply a numerical inversion method to a
distribution defined in SciPy, please also take a look at
<a class="reference internal" href="../../reference/generated/scipy.stats.sampling.FastGeneratorInversion.html#scipy.stats.sampling.FastGeneratorInversion" title="scipy.stats.sampling.FastGeneratorInversion"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.sampling.FastGeneratorInversion</span></code></a>.</p>
</div>
<p>In the above example, we have set up an object of the
<a class="reference internal" href="../../reference/generated/scipy.stats.sampling.TransformedDensityRejection.html#scipy.stats.sampling.TransformedDensityRejection" title="scipy.stats.sampling.TransformedDensityRejection"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedDensityRejection</span></code></a> method to sample from a
standard normal distribution. Now, we can start sampling from our
distribution by calling the <code class="docutils literal notranslate"><span class="pre">rvs</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.145012309736894
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.52444439,  0.90526457, -0.60342305],
       [-1.3598422 ,  0.67659048, -1.53494043],
       [ 0.90594293, -1.15790121, -0.66639133],
       [-0.11179664, -1.00322894,  0.21900045],
       [-0.59994557,  1.33627255,  1.24659843]])
</pre></div>
</div>
</div>
</div>
<p>We can also check that the samples are drawn from the correct distribution
by visualizing the histogram of the samples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">scipy.stats.sampling</span> <span class="kn">import</span> <span class="n">TransformedDensityRejection</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>

<span class="k">class</span> <span class="nc">StandardNormal</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># note that the normalization constant isn&#39;t required</span>
        <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">dpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">StandardNormal</span><span class="p">()</span>
<span class="n">urng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">TransformedDensityRejection</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">urng</span><span class="p">)</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;random variates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PDF(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Transformed Density Rejection Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="This code generates an X-Y plot with the probability distribution function of X on the Y axis and values of X on the X axis. A red trace showing the true distribution is a typical normal distribution with tails near zero at the edges and a smooth peak around the center near 0.4. A blue bar graph of random variates is shown below the red trace with a distribution similar to the truth, but with clear imperfections." src="../../_images/79414ed1be27dcccfba6977b33b67d2d72357ea6e88309ad025861d2c85c27ed.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note the difference between the <code class="docutils literal notranslate"><span class="pre">rvs</span></code> method of the distributions
present in <a class="reference internal" href="../../reference/stats.html#module-scipy.stats" title="scipy.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> and the one provided by these generators.
UNU.RAN generators must be considered independent in a sense that they will
generally produce a different stream of random numbers than the one produced
by the equivalent distribution in <a class="reference internal" href="../../reference/stats.html#module-scipy.stats" title="scipy.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> for any seed. The
implementation of <code class="docutils literal notranslate"><span class="pre">rvs</span></code> in <a class="reference internal" href="../../reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous" title="scipy.stats.rv_continuous"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.rv_continuous</span></code></a> usually relies
on the NumPy module <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random" title="(in NumPy v2.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.random</span></code></a> for well-known distributions (e.g.,
for the normal distribution, the beta distribution) and transformations of
other distributions (e.g., normal inverse Gaussian
<a class="reference internal" href="../../reference/generated/scipy.stats.norminvgauss.html#scipy.stats.norminvgauss" title="scipy.stats.norminvgauss"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.norminvgauss</span></code></a> and the lognormal
<a class="reference internal" href="../../reference/generated/scipy.stats.lognorm.html#scipy.stats.lognorm" title="scipy.stats.lognorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.lognorm</span></code></a> distribution). If no specific method is
implemented, <a class="reference internal" href="../../reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous" title="scipy.stats.rv_continuous"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.rv_continuous</span></code></a> defaults to a numerical
inversion method of the CDF that is very slow. As UNU.RAN transforms uniform
random numbers differently than SciPy or NumPy, the resulting stream of RVs is
different even for the same stream of uniform random numbers. For example, the
random number stream of SciPy’s <a class="reference internal" href="../../reference/generated/scipy.stats.norm.html#scipy.stats.norm" title="scipy.stats.norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code></a> and UNU.RAN’s
<a class="reference internal" href="../../reference/generated/scipy.stats.sampling.TransformedDensityRejection.html#scipy.stats.sampling.TransformedDensityRejection" title="scipy.stats.sampling.TransformedDensityRejection"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedDensityRejection</span></code></a> would not be the same
even for the same <code class="docutils literal notranslate"><span class="pre">random_state</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="kn">from</span> <span class="nn">scipy.stats.sampling</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">TransformedDensityRejection</span>
  <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
  <span class="n">dist</span> <span class="o">=</span> <span class="n">StandardNormal</span><span class="p">()</span>
  <span class="n">urng1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
  <span class="n">urng1_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">urng1</span><span class="p">)</span>
  <span class="n">rng</span> <span class="o">=</span> <span class="n">TransformedDensityRejection</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">urng1</span><span class="p">)</span>
  <span class="n">rng</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
  <span class="c1"># -1.526829048388144</span>
  <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">urng1_copy</span><span class="p">)</span>
  <span class="c1"># 1.3194816698862635</span>
</pre></div>
</div>
</div>
<p>We can pass a <code class="docutils literal notranslate"><span class="pre">domain</span></code> parameter to truncate the distribution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">TransformedDensityRejection</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="n">urng</span><span class="p">)</span>
<span class="n">rng</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.27499538,  0.91880956,  0.27630674],
       [ 0.77859264,  0.56027361,  0.29161653],
       [-0.98503142, -0.07918514, -0.3035628 ],
       [-0.07586644,  0.33001922, -0.32347602],
       [ 0.39236085, -0.10439975,  0.94903208]])
</pre></div>
</div>
</div>
</div>
<p>Invalid and bad arguments are handled either by SciPy or by UNU.RAN. The
latter throws a <a class="reference internal" href="../../reference/generated/scipy.stats.sampling.UNURANError.html#scipy.stats.sampling.UNURANError" title="scipy.stats.sampling.UNURANError"><code class="xref py py-class docutils literal notranslate"><span class="pre">UNURANError</span></code></a> that follows a common format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UNURANError</span><span class="p">:</span> <span class="p">[</span><span class="n">objid</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">object</span> <span class="nb">id</span><span class="o">&gt;</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">reason</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nb">type</span> <span class="n">of</span> <span class="n">error</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;object</span> <span class="pre">id&gt;</span></code> is the ID of the object given by UNU.RAN</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;error</span> <span class="pre">code&gt;</span></code> is an error code representing a type of error.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;reason&gt;</span></code> is the reason why the error occurred.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;type</span> <span class="pre">of</span> <span class="pre">error&gt;</span></code> is a short description of the type of error.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;reason&gt;</span></code> shows what caused the error. This, by itself, should contain
enough information to help debug the error. In addition, <code class="docutils literal notranslate"><span class="pre">&lt;error</span> <span class="pre">id&gt;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&lt;type</span> <span class="pre">of</span> <span class="pre">error&gt;</span></code> can be used to investigate different classes of error in
UNU.RAN. A complete list of all the error codes and their descriptions can be
found in the <a class="reference external" href="http://statmath.wu.ac.at/software/unuran/doc/unuran.html#Errno">Section 8.4 of the UNU.RAN user
manual</a>.</p>
<p>An example of an error generated by UNU.RAN is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>UNURANError: [objid: TDR.003] 50 : PDF(x) &lt; 0.! =&gt; (generator) (possible) invalid data
</pre></div>
</div>
<p>This shows that UNU.RAN failed to initialize an object with ID <code class="docutils literal notranslate"><span class="pre">TDR.003</span></code>
because the PDF was &lt; 0. i.e. negative. This falls under the type
“possible invalid data for the generator” and has error code 50.</p>
<p>Warnings thrown by UNU.RAN also follow the same format.</p>
</section>
<section id="generators-in-scipy-stats-sampling">
<h2>Generators in <a class="reference internal" href="../../reference/stats.sampling.html#module-scipy.stats.sampling" title="scipy.stats.sampling"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats.sampling</span></code></a><a class="headerlink" href="#generators-in-scipy-stats-sampling" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampling_tdr.html">Transformed Density Rejection (TDR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_dau.html">Discrete Alias Urn (DAU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_pinv.html">Polynomial interpolation based INVersion of CDF (PINV)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_dgt.html">Discrete Guide Table (DGT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_hinv.html">Hermite interpolation based INVersion of CDF (HINV)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_srou.html">Simple Ratio-of-Uniforms (SROU)</a></li>
</ul>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
</section>
</section>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Von Neumann, John. “13. various techniques used in connection with
random digits.” Appl. Math Ser 12.36-38 (1951): 3. <a class="reference external" href="https://mcnp.lanl.gov/pdf_files/InBook_Computing_1961_Neumann_JohnVonNeumannCollectedWorks_VariousTechniquesUsedinConnectionwithRandomDigits.pdf">https://mcnp.lanl.gov/pdf_files/InBook_Computing_1961_Neumann_JohnVonNeumannCollectedWorks_VariousTechniquesUsedinConnectionwithRandomDigits.pdf</a></p>
</aside>
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>UNU.RAN User Manual, <a class="reference external" href="https://statmath.wu.ac.at/unuran/doc/unuran.html">https://statmath.wu.ac.at/unuran/doc/unuran.html</a></p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Leydold, Josef, Wolfgang Hörmann, and Halis Sak. “An R Interface to
the UNU.RAN Library for Universal Random Variate Generators.”,
<a class="reference external" href="https://cran.r-project.org/web/packages/Runuran/vignettes/Runuran.pdf">https://cran.r-project.org/web/packages/Runuran/vignettes/Runuran.pdf</a></p>
</aside>
</aside>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="discrete_yulesimon.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Yule-Simon Distribution</p>
      </div>
    </a>
    <a class="right-next"
       href="sampling_tdr.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Transformed Density Rejection (TDR)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-concepts-of-the-interface">Basic concepts of the Interface</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generators-in-scipy-stats-sampling">Generators in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats.sampling</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2008-2024, The SciPy community.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>