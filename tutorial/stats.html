
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Statistics (scipy.stats) &#8212; SciPy v1.7.0.dev0+1036.4ec6f29 Manual</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/scipy.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Discrete Statistical Distributions" href="stats/discrete.html" />
    <link rel="prev" title="Spatial data structures and algorithms (scipy.spatial)" href="spatial.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/scipyshiny_small.png" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../reference/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../dev/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../release.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/scipy/scipy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="general.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="special.html">
   Special functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.special
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="integrate.html">
   Integration (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimize.html">
   Optimization (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.optimize
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpolate.html">
   Interpolation (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.interpolate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fft.html">
   Fourier Transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fft
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signal.html">
   Signal Processing (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.signal
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linalg.html">
   Linear Algebra (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arpack.html">
   Sparse eigenvalue problems with ARPACK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="csgraph.html">
   Compressed Sparse Graph Routines (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.sparse.csgraph
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spatial.html">
   Spatial data structures and algorithms (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.spatial
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   Statistics (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.stats
    </span>
   </code>
   )
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="stats/discrete.html">
     Discrete Statistical Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stats/continuous.html">
     Continuous Statistical Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ndimage.html">
   Multidimensional image processing (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="io.html">
   File IO (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.io
    </span>
   </code>
   )
  </a>
 </li>
</ul>

    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-variables">
   Random variables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-help">
     Getting help
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#common-methods">
     Common methods
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-number-generation">
     Random number generation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shifting-and-scaling">
     Shifting and scaling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shape-parameters">
     Shape parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#freezing-a-distribution">
     Freezing a distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#broadcasting">
     Broadcasting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specific-points-for-discrete-distributions">
     Specific points for discrete distributions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitting-distributions">
     Fitting distributions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#performance-issues-and-cautionary-remarks">
     Performance issues and cautionary remarks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remaining-issues">
     Remaining issues
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-specific-distributions">
   Building specific distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-a-continuous-distribution-i-e-subclassing-rv-continuous">
     Making a continuous distribution, i.e., subclassing
     <code class="docutils literal notranslate">
      <span class="pre">
       rv_continuous
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subclassing-rv-discrete">
     Subclassing
     <code class="docutils literal notranslate">
      <span class="pre">
       rv_discrete
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysing-one-sample">
   Analysing one sample
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-statistics">
     Descriptive statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#t-test-and-ks-test">
     T-test and KS-test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tails-of-the-distribution">
     Tails of the distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-tests-for-normal-distributions">
     Special tests for normal distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparing-two-samples">
   Comparing two samples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparing-means">
     Comparing means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kolmogorov-smirnov-test-for-two-samples-ks-2samp">
     Kolmogorov-Smirnov test for two samples ks_2samp
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kernel-density-estimation">
   Kernel density estimation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#univariate-estimation">
     Univariate estimation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multivariate-estimation">
     Multivariate estimation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiscale-graph-correlation-mgc">
     Multiscale Graph Correlation (MGC)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quasi-monte-carlo">
   Quasi-Monte Carlo
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-discrepancy">
     Calculate the discrepancy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-a-qmc-engine">
     Using a QMC engine
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-a-qmc-engine-i-e-subclassing-qmcengine">
     Making a QMC engine, i.e., subclassing
     <code class="docutils literal notranslate">
      <span class="pre">
       QMCEngine
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#guidelines-on-using-qmc">
     Guidelines on using QMC
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="statistics-scipy-stats">
<h1>Statistics (<a class="reference internal" href="../reference/stats.html#module-scipy.stats" title="scipy.stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats</span></code></a>)<a class="headerlink" href="#statistics-scipy-stats" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we discuss many, but certainly not all, features of
<code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>. The intention here is to provide a user with a
working knowledge of this package. We refer to the
<a class="reference internal" href="../reference/stats.html#statsrefmanual"><span class="std std-ref">reference manual</span></a> for further details.</p>
<p>Note: This documentation is work in progress.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="stats/discrete.html">Discrete Statistical Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats/continuous.html">Continuous Statistical Distributions</a></li>
</ul>
</div>
</section>
<section id="random-variables">
<h2>Random variables<a class="headerlink" href="#random-variables" title="Permalink to this headline">¶</a></h2>
<p>There are two general distribution classes that have been implemented
for encapsulating <a class="reference internal" href="stats/continuous.html#continuous-random-variables"><span class="std std-ref">continuous random variables</span></a> and <a class="reference internal" href="stats/discrete.html#discrete-random-variables"><span class="std std-ref">discrete random variables</span></a>. Over 80 continuous random variables
(RVs) and 10 discrete random variables have been implemented using
these classes. Besides this, new routines and distributions can be
easily added by the end user. (If you create one, please contribute it.)</p>
<p>All of the statistics functions are located in the sub-package
<a class="reference internal" href="../reference/stats.html#module-scipy.stats" title="scipy.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> and a fairly complete listing of these functions
can be obtained using <code class="docutils literal notranslate"><span class="pre">info(stats)</span></code>. The list of the random
variables available can also be obtained from the docstring for the
stats sub-package.</p>
<p>In the discussion below, we mostly focus on continuous RVs. Nearly everything
also applies to discrete variables, but we point out some differences
here: <a class="reference internal" href="#discrete-points-label"><span class="std std-ref">Specific points for discrete distributions</span></a>.</p>
<p>In the code samples below, we assume that the <a class="reference internal" href="../reference/stats.html#module-scipy.stats" title="scipy.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> package
is imported as</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>
</div>
<p>and in some cases we assume that individual objects are imported as</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
<section id="getting-help">
<h3>Getting help<a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h3>
<p>First of all, all distributions are accompanied with help
functions. To obtain just some basic information, we print the relevant
docstring: <code class="docutils literal notranslate"><span class="pre">print(stats.norm.__doc__)</span></code>.</p>
<p>To find the support, i.e., upper and lower bounds of the distribution,
call:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bounds of distribution lower: </span><span class="si">%s</span><span class="s1">, upper: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">norm</span><span class="o">.</span><span class="n">support</span><span class="p">())</span>
<span class="go">bounds of distribution lower: -inf, upper: inf</span>
</pre></div>
</div>
<p>We can list all methods and properties of the distribution with
<code class="docutils literal notranslate"><span class="pre">dir(norm)</span></code>. As it turns out, some of the methods are private,
although they are not named as such (their names do not start
with a leading underscore), for example <code class="docutils literal notranslate"><span class="pre">veccdf</span></code>, are only available
for internal calculation (those methods will give warnings when one tries to
use them, and will be removed at some point).</p>
<p>To obtain the <em>real</em> main methods, we list the methods of the frozen
distribution. (We explain the meaning of a <em class="xref py py-obj">frozen</em> distribution
below).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rv</span> <span class="o">=</span> <span class="n">norm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>  <span class="c1"># reformatted</span>
<span class="go">[&#39;__class__&#39;, &#39;__delattr__&#39;, &#39;__dict__&#39;, &#39;__dir__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;,</span>
<span class="go"> &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;,</span>
<span class="go"> &#39;__init__&#39;, &#39;__le__&#39;, &#39;__lt__&#39;, &#39;__module__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;,</span>
<span class="go"> &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;,</span>
<span class="go"> &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;__weakref__&#39;, &#39;a&#39;, &#39;args&#39;, &#39;b&#39;, &#39;cdf&#39;,</span>
<span class="go"> &#39;dist&#39;, &#39;entropy&#39;, &#39;expect&#39;, &#39;interval&#39;, &#39;isf&#39;, &#39;kwds&#39;, &#39;logcdf&#39;,</span>
<span class="go"> &#39;logpdf&#39;, &#39;logpmf&#39;, &#39;logsf&#39;, &#39;mean&#39;, &#39;median&#39;, &#39;moment&#39;, &#39;pdf&#39;, &#39;pmf&#39;,</span>
<span class="go"> &#39;ppf&#39;, &#39;random_state&#39;, &#39;rvs&#39;, &#39;sf&#39;, &#39;stats&#39;, &#39;std&#39;, &#39;var&#39;]</span>
</pre></div>
</div>
<p>Finally, we can obtain the list of available distribution through
introspection:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist_continu</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span> <span class="k">if</span>
<span class="gp">... </span>                <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_discrete</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span> <span class="k">if</span>
<span class="gp">... </span>                 <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_discrete</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of continuous distributions: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist_continu</span><span class="p">))</span>
<span class="go">number of continuous distributions: 103</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of discrete distributions:   </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist_discrete</span><span class="p">))</span>
<span class="go">number of discrete distributions:   19</span>
</pre></div>
</div>
</section>
<section id="common-methods">
<h3>Common methods<a class="headerlink" href="#common-methods" title="Permalink to this headline">¶</a></h3>
<p>The main public methods for continuous  RVs are:</p>
<ul class="simple">
<li><p>rvs:   Random Variates</p></li>
<li><p>pdf:   Probability Density Function</p></li>
<li><p>cdf:   Cumulative Distribution Function</p></li>
<li><p>sf:    Survival Function (1-CDF)</p></li>
<li><p>ppf:   Percent Point Function (Inverse of CDF)</p></li>
<li><p>isf:   Inverse Survival Function (Inverse of SF)</p></li>
<li><p>stats: Return mean, variance, (Fisher’s) skew, or (Fisher’s) kurtosis</p></li>
<li><p>moment: non-central moments of the distribution</p></li>
</ul>
<p>Let’s take a normal RV as an example.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0.5</span>
</pre></div>
</div>
<p>To compute the <code class="docutils literal notranslate"><span class="pre">cdf</span></code> at a number of points, we can pass a list or a numpy array.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">array([ 0.15865525,  0.5,  0.84134475])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="go">array([ 0.15865525,  0.5,  0.84134475])</span>
</pre></div>
</div>
<p>Thus, the basic methods, such as <em class="xref py py-obj">pdf</em>, <em class="xref py py-obj">cdf</em>, and so on, are vectorized.</p>
<p>Other generally useful methods are supported too:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">norm</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">norm</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="go">(0.0, 1.0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s2">&quot;mv&quot;</span><span class="p">)</span>
<span class="go">(array(0.0), array(1.0))</span>
</pre></div>
</div>
<p>To find the median of a distribution, we can use the percent point
function <code class="docutils literal notranslate"><span class="pre">ppf</span></code>, which is the inverse of the <code class="docutils literal notranslate"><span class="pre">cdf</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>To generate a sequence of random variates, use the <code class="docutils literal notranslate"><span class="pre">size</span></code> keyword
argument:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([-0.35687759,  1.34347647, -0.11710531])   # random</span>
</pre></div>
</div>
<p>Don’t think that <code class="docutils literal notranslate"><span class="pre">norm.rvs(5)</span></code> generates 5 variates:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5.471435163732493  # random</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">5</span></code> with no keyword is being interpreted as the first possible
keyword argument, <code class="docutils literal notranslate"><span class="pre">loc</span></code>, which is the first of a pair of keyword arguments
taken by all continuous distributions.
This brings us to the topic of the next subsection.</p>
</section>
<section id="random-number-generation">
<h3>Random number generation<a class="headerlink" href="#random-number-generation" title="Permalink to this headline">¶</a></h3>
<p>Drawing random numbers relies on generators from <a class="reference external" href="https://numpy.org/devdocs/reference/random/index.html#module-numpy.random" title="(in NumPy v1.21.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random</span></code></a> package.
In the examples above, the specific stream of
random numbers is not reproducible across runs. To achieve reproducibility,
you can explicitly <em>seed</em> a random number generator. In NumPy, a generator
is an instance of <a class="reference external" href="https://numpy.org/devdocs/reference/random/generator.html#numpy.random.Generator" title="(in NumPy v1.21.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code></a>. Here is the canonical way to create
a generator:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
</pre></div>
</div>
<p>And fixing the seed can be done like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># do NOT copy this value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">(</span><span class="mi">301439351238479871608357552876690613766</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use this number or common values such as 0. Using just a
small set of seeds to instantiate larger state spaces means that
there are some initial states that are impossible to reach. This
creates some biases if everyone uses such values. A good way to
get a seed is to use a <a class="reference external" href="https://numpy.org/devdocs/reference/random/bit_generators/generated/numpy.random.SeedSequence.html#numpy.random.SeedSequence" title="(in NumPy v1.21.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.SeedSequence</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">SeedSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SeedSequence</span><span class="p">()</span><span class="o">.</span><span class="n">entropy</span><span class="p">)</span>
<span class="go">301439351238479871608357552876690613766  # random</span>
</pre></div>
</div>
</div>
<p>The <em class="xref py py-obj">random_state</em> parameter in distributions accepts an instance of
<a class="reference external" href="https://numpy.org/devdocs/reference/random/generator.html#numpy.random.Generator" title="(in NumPy v1.21.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code></a> class, or an integer, which is then used to
seed an internal <code class="docutils literal notranslate"><span class="pre">Generator</span></code> object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="go">array([ 0.47143516, -1.19097569,  1.43270697, -0.3126519 , -0.72058873])  # random</span>
</pre></div>
</div>
<p>For further info, see <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html">NumPy’s documentation</a>.</p>
</section>
<section id="shifting-and-scaling">
<h3>Shifting and scaling<a class="headerlink" href="#shifting-and-scaling" title="Permalink to this headline">¶</a></h3>
<p>All continuous distributions take <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> as keyword
parameters to adjust the location and scale of the distribution,
e.g., for the standard normal distribution, the location is the mean and
the scale is the standard deviation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s2">&quot;mv&quot;</span><span class="p">)</span>
<span class="go">(array(3.0), array(16.0))</span>
</pre></div>
</div>
<p>In many cases, the standardized distribution for a random variable <code class="docutils literal notranslate"><span class="pre">X</span></code>
is obtained through the transformation <code class="docutils literal notranslate"><span class="pre">(X</span> <span class="pre">-</span> <span class="pre">loc)</span> <span class="pre">/</span> <span class="pre">scale</span></code>. The
default values are <code class="docutils literal notranslate"><span class="pre">loc</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>Smart use of <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> can help modify the standard
distributions in many ways. To illustrate the scaling further, the
<code class="docutils literal notranslate"><span class="pre">cdf</span></code> of an exponentially distributed RV with mean <span class="math notranslate nohighlight">\(1/\lambda\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[F(x) = 1 - \exp(-\lambda x)\]</div>
<p>By applying the scaling rule above, it can be seen that by
taking <code class="docutils literal notranslate"><span class="pre">scale</span>&#160; <span class="pre">=</span> <span class="pre">1./lambda</span></code> we get the proper scale.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">expon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expon</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>
<span class="go">3.0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Distributions that take shape parameters may
require more than simple application of <code class="docutils literal notranslate"><span class="pre">loc</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">scale</span></code> to achieve the desired form. For example, the
distribution of 2-D vector lengths given a constant vector
of length <span class="math notranslate nohighlight">\(R\)</span> perturbed by independent N(0, <span class="math notranslate nohighlight">\(\sigma^2\)</span>)
deviations in each component is
rice(<span class="math notranslate nohighlight">\(R/\sigma\)</span>, scale= <span class="math notranslate nohighlight">\(\sigma\)</span>). The first argument
is a shape parameter that needs to be scaled along with <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
<p>The uniform distribution is also interesting:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniform</span><span class="o">.</span><span class="n">cdf</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">array([ 0.  ,  0.  ,  0.25,  0.5 ,  0.75,  1.  ])</span>
</pre></div>
</div>
<p>Finally, recall from the previous paragraph that we are left with the
problem of the meaning of <code class="docutils literal notranslate"><span class="pre">norm.rvs(5)</span></code>. As it turns out, calling a
distribution like this, the first argument, i.e., the 5, gets passed
to set the <code class="docutils literal notranslate"><span class="pre">loc</span></code> parameter. Let’s see:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
<span class="go">5.0098355106969992  # random</span>
</pre></div>
</div>
<p>Thus, to explain the output of the example of the last section:
<code class="docutils literal notranslate"><span class="pre">norm.rvs(5)</span></code> generates a single normally distributed random variate with
mean <code class="docutils literal notranslate"><span class="pre">loc=5</span></code>, because of the default <code class="docutils literal notranslate"><span class="pre">size=1</span></code>.</p>
<p>We recommend that you set <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> parameters explicitly, by
passing the values as keywords rather than as arguments. Repetition
can be minimized when calling more than one method of a given RV by
using the technique of <a class="reference internal" href="#freezing-a-distribution">Freezing a Distribution</a>, as explained below.</p>
</section>
<section id="shape-parameters">
<h3>Shape parameters<a class="headerlink" href="#shape-parameters" title="Permalink to this headline">¶</a></h3>
<p>While a general continuous random variable can be shifted and scaled
with the <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> parameters, some distributions require
additional shape parameters. For instance, the gamma distribution with density</p>
<div class="math notranslate nohighlight">
\[\gamma(x, a) = \frac{\lambda (\lambda x)^{a-1}}{\Gamma(a)} e^{-\lambda x}\;,\]</div>
<p>requires the shape parameter <span class="math notranslate nohighlight">\(a\)</span>. Observe that setting
<span class="math notranslate nohighlight">\(\lambda\)</span> can be obtained by setting the <code class="docutils literal notranslate"><span class="pre">scale</span></code> keyword to
<span class="math notranslate nohighlight">\(1/\lambda\)</span>.</p>
<p>Let’s check the number and name of the shape parameters of the gamma
distribution. (We know from the above that this should be 1.)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span><span class="o">.</span><span class="n">numargs</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span><span class="o">.</span><span class="n">shapes</span>
<span class="go">&#39;a&#39;</span>
</pre></div>
</div>
<p>Now, we set the value of the shape variable to 1 to obtain the
exponential distribution, so that we compare easily whether we get the
results we expect.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s2">&quot;mv&quot;</span><span class="p">)</span>
<span class="go">(array(2.0), array(4.0))</span>
</pre></div>
</div>
<p>Notice that we can also specify shape parameters as keywords:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s2">&quot;mv&quot;</span><span class="p">)</span>
<span class="go">(array(2.0), array(4.0))</span>
</pre></div>
</div>
</section>
<section id="freezing-a-distribution">
<h3>Freezing a distribution<a class="headerlink" href="#freezing-a-distribution" title="Permalink to this headline">¶</a></h3>
<p>Passing the <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> keywords time and again can become
quite bothersome. The concept of <em class="xref py py-obj">freezing</em> a RV is used to
solve such problems.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rv</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<p>By using <code class="docutils literal notranslate"><span class="pre">rv</span></code> we no longer have to include the scale or the shape
parameters anymore. Thus, distributions can be used in one of two
ways, either by passing all distribution parameters to each method
call (such as we did earlier) or by freezing the parameters for the
instance of the distribution. Let us check this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rv</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">rv</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="go">(2.0, 2.0)</span>
</pre></div>
</div>
<p>This is, indeed, what we should get.</p>
</section>
<section id="broadcasting">
<h3>Broadcasting<a class="headerlink" href="#broadcasting" title="Permalink to this headline">¶</a></h3>
<p>The basic methods <code class="docutils literal notranslate"><span class="pre">pdf</span></code>, and so on, satisfy the usual numpy broadcasting rules. For
example, we can calculate the critical values for the upper tail of
the t distribution for different probabilities and degrees of freedom.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[[</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">]])</span>
<span class="go">array([[ 1.37218364,  1.81246112,  2.76376946],</span>
<span class="go">       [ 1.36343032,  1.79588482,  2.71807918]])</span>
</pre></div>
</div>
<p>Here, the first row contains the critical values for 10 degrees of freedom
and the second row for 11 degrees of freedom (d.o.f.). Thus, the
broadcasting rules give the same result of calling <code class="docutils literal notranslate"><span class="pre">isf</span></code> twice:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">array([ 1.37218364,  1.81246112,  2.76376946])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="mi">11</span><span class="p">)</span>
<span class="go">array([ 1.36343032,  1.79588482,  2.71807918])</span>
</pre></div>
</div>
<p>If the array with probabilities, i.e., <code class="docutils literal notranslate"><span class="pre">[0.1,</span> <span class="pre">0.05,</span> <span class="pre">0.01]</span></code> and the
array of degrees of freedom i.e., <code class="docutils literal notranslate"><span class="pre">[10,</span> <span class="pre">11,</span> <span class="pre">12]</span></code>, have the same
array shape, then element-wise matching is used. As an example, we can
obtain the 10% tail for 10 d.o.f., the 5% tail for 11 d.o.f. and the
1% tail for 12 d.o.f. by calling</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="go">array([ 1.37218364,  1.79588482,  2.68099799])</span>
</pre></div>
</div>
</section>
<section id="specific-points-for-discrete-distributions">
<span id="discrete-points-label"></span><h3>Specific points for discrete distributions<a class="headerlink" href="#specific-points-for-discrete-distributions" title="Permalink to this headline">¶</a></h3>
<p>Discrete distributions have mostly the same basic methods as the
continuous distributions. However <code class="docutils literal notranslate"><span class="pre">pdf</span></code> is replaced by the probability
mass function <code class="docutils literal notranslate"><span class="pre">pmf</span></code>, no estimation methods, such as fit, are
available, and <code class="docutils literal notranslate"><span class="pre">scale</span></code> is not a valid keyword parameter. The
location parameter, keyword <code class="docutils literal notranslate"><span class="pre">loc</span></code>, can still be used to shift the
distribution.</p>
<p>The computation of the cdf requires some extra attention. In the case
of continuous distribution, the cumulative distribution function is, in
most standard cases, strictly monotonic increasing in the bounds (a,b)
and has, therefore, a unique inverse. The cdf of a discrete
distribution, however, is a step function, hence the inverse cdf,
i.e., the percent point function, requires a different definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="nb">min</span><span class="p">{</span><span class="n">x</span> <span class="p">:</span> <span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">q</span><span class="p">,</span> <span class="n">x</span> <span class="n">integer</span><span class="p">}</span>
</pre></div>
</div>
<p>For further info, see the docs <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/stats/discrete.html#percent-point-function-inverse-cdf">here</a>.</p>
<p>We can look at the hypergeometric distribution as an example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">hypergeom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
<p>If we use the cdf at some integer points and then evaluate the ppf at those
cdf values, we get the initial integers back, for example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([0, 2, 4, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prb</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prb</span>
<span class="go">array([  1.03199174e-04,   5.21155831e-02,   6.08359133e-01,</span>
<span class="go">         9.89783282e-01])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hypergeom</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">prb</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="go">array([ 0.,  2.,  4.,  6.])</span>
</pre></div>
</div>
<p>If we use values that are not at the kinks of the cdf step function, we get
the next higher integer back:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hypergeom</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">prb</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="go">array([ 1.,  3.,  5.,  7.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hypergeom</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">prb</span> <span class="o">-</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="go">array([ 0.,  2.,  4.,  6.])</span>
</pre></div>
</div>
</section>
<section id="fitting-distributions">
<h3>Fitting distributions<a class="headerlink" href="#fitting-distributions" title="Permalink to this headline">¶</a></h3>
<p>The main additional methods of the not frozen distribution are related
to the estimation of distribution parameters:</p>
<ul class="simple">
<li><dl class="simple">
<dt>fit:   maximum likelihood estimation of distribution parameters, including location</dt><dd><p>and scale</p>
</dd>
</dl>
</li>
<li><p>fit_loc_scale: estimation of location and scale when shape parameters are given</p></li>
<li><p>nnlf:  negative log likelihood function</p></li>
<li><p>expect: calculate the expectation of a function against the pdf or pmf</p></li>
</ul>
</section>
<section id="performance-issues-and-cautionary-remarks">
<span id="performance-issues-label"></span><h3>Performance issues and cautionary remarks<a class="headerlink" href="#performance-issues-and-cautionary-remarks" title="Permalink to this headline">¶</a></h3>
<p>The performance of the individual methods, in terms of speed, varies
widely by distribution and method. The results of a method are
obtained in one of two ways: either by explicit calculation, or by a
generic algorithm that is independent of the specific distribution.</p>
<p>Explicit calculation, on the one hand, requires that the method is
directly specified for the given distribution, either through analytic
formulas or through special functions in <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code> or
<code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> for <code class="docutils literal notranslate"><span class="pre">rvs</span></code>. These are usually relatively fast
calculations.</p>
<p>The generic methods, on the other hand, are used if the distribution
does not specify any explicit calculation. To define a distribution,
only one of pdf or cdf is necessary; all other methods can be derived
using numeric integration and root finding. However, these indirect
methods can be <em class="xref py py-obj">very</em> slow. As an example, <code class="docutils literal notranslate"><span class="pre">rgh</span> <span class="pre">=</span>
<span class="pre">stats.gausshyper.rvs(0.5,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">size=100)</span></code> creates random
variables in a very indirect way and takes about 19 seconds for 100
random variables on my computer, while one million random variables
from the standard normal or from the t distribution take just above
one second.</p>
</section>
<section id="remaining-issues">
<h3>Remaining issues<a class="headerlink" href="#remaining-issues" title="Permalink to this headline">¶</a></h3>
<p>The distributions in <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> have recently been corrected and improved
and gained a considerable test suite; however, a few issues remain:</p>
<ul class="simple">
<li><p>The distributions have been tested over some range of parameters;
however, in some corner ranges, a few incorrect results may remain.</p></li>
<li><p>The maximum likelihood estimation in <em class="xref py py-obj">fit</em> does not work with
default starting parameters for all distributions and the user
needs to supply good starting parameters. Also, for some
distribution using a maximum likelihood estimator might
inherently not be the best choice.</p></li>
</ul>
</section>
</section>
<section id="building-specific-distributions">
<h2>Building specific distributions<a class="headerlink" href="#building-specific-distributions" title="Permalink to this headline">¶</a></h2>
<p>The next examples shows how to build your own distributions. Further
examples show the usage of the distributions and some statistical
tests.</p>
<section id="making-a-continuous-distribution-i-e-subclassing-rv-continuous">
<h3>Making a continuous distribution, i.e., subclassing <code class="docutils literal notranslate"><span class="pre">rv_continuous</span></code><a class="headerlink" href="#making-a-continuous-distribution-i-e-subclassing-rv-continuous" title="Permalink to this headline">¶</a></h3>
<p>Making continuous distributions is fairly simple.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">deterministic_gen</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deterministic</span> <span class="o">=</span> <span class="n">deterministic_gen</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;deterministic&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deterministic</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([ 0.,  0.,  0.,  0.,  0.,  0.,  1.,  1.,  1.,  1.,  1.,  1.])</span>
</pre></div>
</div>
<p>Interestingly,  the <code class="docutils literal notranslate"><span class="pre">pdf</span></code> is now computed automatically:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deterministic</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,</span>
<span class="go">         5.83333333e+04,   4.16333634e-12,   4.16333634e-12,</span>
<span class="go">         4.16333634e-12,   4.16333634e-12,   4.16333634e-12])</span>
</pre></div>
</div>
<p>Be aware of the performance issues mentioned in
<a class="reference internal" href="#performance-issues-label"><span class="std std-ref">Performance issues and cautionary remarks</span></a>. The computation of unspecified
common methods can become very slow, since only general methods are
called, which, by their very nature, cannot use any specific
information about the distribution. Thus, as a cautionary example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad</span><span class="p">(</span><span class="n">deterministic</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">)</span>
<span class="go">(4.163336342344337e-13, 0.0)</span>
</pre></div>
</div>
<p>But this is not correct: the integral over this pdf should be 1. Let’s make the
integration interval smaller:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quad</span><span class="p">(</span><span class="n">deterministic</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>  <span class="c1"># warning removed</span>
<span class="go">(1.000076872229173, 0.0010625571718182458)</span>
</pre></div>
</div>
<p>This looks better. However, the problem originated from the fact that
the pdf is not specified in the class definition of the deterministic
distribution.</p>
</section>
<section id="subclassing-rv-discrete">
<h3>Subclassing <code class="docutils literal notranslate"><span class="pre">rv_discrete</span></code><a class="headerlink" href="#subclassing-rv-discrete" title="Permalink to this headline">¶</a></h3>
<p>In the following, we use <a class="reference internal" href="../reference/generated/scipy.stats.rv_discrete.html#scipy.stats.rv_discrete" title="scipy.stats.rv_discrete"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats.rv_discrete</span></code></a> to generate a discrete
distribution that has the probabilities of the truncated normal for the
intervals centered around the integers.</p>
<p><strong>General info</strong></p>
<p>From the docstring of rv_discrete, <code class="docutils literal notranslate"><span class="pre">help(stats.rv_discrete)</span></code>,</p>
<blockquote>
<div><p>“You can construct an arbitrary discrete rv where P{X=xk} = pk by
passing to the rv_discrete initialization method (through the values=
keyword) a tuple of sequences (xk, pk) which describes only those
values of X (xk) that occur with nonzero probability (pk).”</p>
</div></blockquote>
<p>Next to this, there are some further requirements for this approach to
work:</p>
<ul class="simple">
<li><p>The keyword <em class="xref py py-obj">name</em> is required.</p></li>
<li><p>The support points of the distribution xk have to be integers.</p></li>
<li><p>The number of significant digits (decimals) needs to be specified.</p></li>
</ul>
<p>In fact, if the last two requirements are not satisfied, an exception
may be raised or the resulting numbers may be incorrect.</p>
<p><strong>An example</strong></p>
<p>Let’s do the work. First:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">npoints</span> <span class="o">=</span> <span class="mi">20</span>   <span class="c1"># number of integer support points of the distribution minus 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npointsh</span> <span class="o">=</span> <span class="n">npoints</span> <span class="o">//</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npointsf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">npoints</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nbound</span> <span class="o">=</span> <span class="mi">4</span>   <span class="c1"># bounds for the truncated normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normbound</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">npointsf</span><span class="p">)</span> <span class="o">*</span> <span class="n">nbound</span>   <span class="c1"># actual bounds of truncated normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">npointsh</span><span class="p">,</span> <span class="n">npointsh</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># integer grid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridlimitsnorm</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">npointsh</span> <span class="o">*</span> <span class="n">nbound</span>   <span class="c1"># bin limits for the truncnorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridlimits</span> <span class="o">=</span> <span class="n">grid</span> <span class="o">-</span> <span class="mf">0.5</span>   <span class="c1"># used later in the analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">truncnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">gridlimitsnorm</span><span class="p">,</span> <span class="o">-</span><span class="n">normbound</span><span class="p">,</span> <span class="n">normbound</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridint</span> <span class="o">=</span> <span class="n">grid</span>
</pre></div>
</div>
<p>And, finally, we can subclass <code class="docutils literal notranslate"><span class="pre">rv_discrete</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">normdiscrete</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_discrete</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">gridint</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">7</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;normdiscrete&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have defined the distribution, we have access to all
common methods of discrete distributions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean = </span><span class="si">%6.4f</span><span class="s1">, variance = </span><span class="si">%6.4f</span><span class="s1">, skew = </span><span class="si">%6.4f</span><span class="s1">, kurtosis = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span>
<span class="gp">... </span>      <span class="n">normdiscrete</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">))</span>
<span class="go">mean = -0.0000, variance = 6.3302, skew = 0.0000, kurtosis = -0.0076</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">normdiscrete</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Testing the implementation</strong></p>
<p>Let’s generate a random sample and compare observed frequencies with
the probabilities.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_sample</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rvs</span> <span class="o">=</span> <span class="n">normdiscrete</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">gridlimits</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfreq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">gridint</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">probs</span><span class="o">*</span><span class="n">n_sample</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sfreq</span><span class="p">)</span>
<span class="go">[[-1.00000000e+01  0.00000000e+00  2.95019349e-02]  # random</span>
<span class="go"> [-9.00000000e+00  0.00000000e+00  1.32294142e-01]</span>
<span class="go"> [-8.00000000e+00  0.00000000e+00  5.06497902e-01]</span>
<span class="go"> [-7.00000000e+00  2.00000000e+00  1.65568919e+00]</span>
<span class="go"> [-6.00000000e+00  1.00000000e+00  4.62125309e+00]</span>
<span class="go"> [-5.00000000e+00  9.00000000e+00  1.10137298e+01]</span>
<span class="go"> [-4.00000000e+00  2.60000000e+01  2.24137683e+01]</span>
<span class="go"> [-3.00000000e+00  3.70000000e+01  3.89503370e+01]</span>
<span class="go"> [-2.00000000e+00  5.10000000e+01  5.78004747e+01]</span>
<span class="go"> [-1.00000000e+00  7.10000000e+01  7.32455414e+01]</span>
<span class="go"> [ 0.00000000e+00  7.40000000e+01  7.92618251e+01]</span>
<span class="go"> [ 1.00000000e+00  8.90000000e+01  7.32455414e+01]</span>
<span class="go"> [ 2.00000000e+00  5.50000000e+01  5.78004747e+01]</span>
<span class="go"> [ 3.00000000e+00  5.00000000e+01  3.89503370e+01]</span>
<span class="go"> [ 4.00000000e+00  1.70000000e+01  2.24137683e+01]</span>
<span class="go"> [ 5.00000000e+00  1.10000000e+01  1.10137298e+01]</span>
<span class="go"> [ 6.00000000e+00  4.00000000e+00  4.62125309e+00]</span>
<span class="go"> [ 7.00000000e+00  3.00000000e+00  1.65568919e+00]</span>
<span class="go"> [ 8.00000000e+00  0.00000000e+00  5.06497902e-01]</span>
<span class="go"> [ 9.00000000e+00  0.00000000e+00  1.32294142e-01]</span>
<span class="go"> [ 1.00000000e+01  0.00000000e+00  2.95019349e-02]]</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/normdiscr_plot1.png" class="plot-directive" src="../_images/normdiscr_plot1.png" />
</figure>
<figure class="align-center">
<img alt="../_images/normdiscr_plot2.png" class="plot-directive" src="../_images/normdiscr_plot2.png" />
</figure>
<p>Next, we can test whether our sample was generated by our norm-discrete
distribution. This also verifies whether the random numbers were generated
correctly.</p>
<p>The chisquare test requires that there are a minimum number of observations
in each bin. We combine the tail bins into larger bins so that they contain
enough observations.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">f</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">probs</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">probs</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">probs</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ch2</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">p2</span><span class="o">*</span><span class="n">n_sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chisquare for normdiscrete: chi2 = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ch2</span><span class="p">,</span> <span class="n">pval</span><span class="p">))</span>
<span class="go">chisquare for normdiscrete: chi2 = 12.466 pvalue = 0.4090  # random</span>
</pre></div>
</div>
<p>The pvalue in this case is high, so we can be quite confident that
our random sample was actually generated by the distribution.</p>
</section>
</section>
<section id="analysing-one-sample">
<h2>Analysing one sample<a class="headerlink" href="#analysing-one-sample" title="Permalink to this headline">¶</a></h2>
<p>First, we create some random variables. We set a seed so that in each run
we get identical results to look at. As an example we take a sample from
the Student t distribution:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we set the required shape parameter of the t distribution, which
in statistics corresponds to the degrees of freedom, to 10. Using size=1000 means
that our sample consists of 1000 independently drawn (pseudo) random numbers.
Since we did not specify the keyword arguments <em class="xref py py-obj">loc</em> and <em class="xref py py-obj">scale</em>, those are
set to their default values zero and one.</p>
<section id="descriptive-statistics">
<h3>Descriptive statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this headline">¶</a></h3>
<p><em class="xref py py-obj">x</em> is a numpy array, and we have direct access to all array methods, e.g.,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>   <span class="c1"># equivalent to np.min(x)</span>
<span class="go">-3.78975572422  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>   <span class="c1"># equivalent to np.max(x)</span>
<span class="go">5.26327732981  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># equivalent to np.mean(x)</span>
<span class="go">0.0140610663985  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>   <span class="c1"># equivalent to np.var(x))</span>
<span class="go">1.28899386208  # random</span>
</pre></div>
</div>
<p>How do the sample properties compare to their theoretical counterparts?</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">smin</span><span class="p">,</span> <span class="n">smax</span><span class="p">),</span> <span class="n">sm</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">sk</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sstr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%-14s</span><span class="s1"> mean = </span><span class="si">%6.4f</span><span class="s1">, variance = </span><span class="si">%6.4f</span><span class="s1">, skew = </span><span class="si">%6.4f</span><span class="s1">, kurtosis = </span><span class="si">%6.4f</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sstr</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;distribution:&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span> <span class="p">,</span><span class="n">k</span><span class="p">))</span>
<span class="go">distribution:  mean = 0.0000, variance = 1.2500, skew = 0.0000, kurtosis = 1.0000  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sstr</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;sample:&#39;</span><span class="p">,</span> <span class="n">sm</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">sk</span><span class="p">))</span>
<span class="go">sample:        mean = 0.0141, variance = 1.2903, skew = 0.2165, kurtosis = 1.0556  # random</span>
</pre></div>
</div>
<p>Note: <a class="reference internal" href="../reference/generated/scipy.stats.describe.html#scipy.stats.describe" title="scipy.stats.describe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats.describe</span></code></a> uses the unbiased estimator for the variance, while
np.var is the biased estimator.</p>
<p>For our sample the sample statistics differ a by a small amount from
their theoretical counterparts.</p>
</section>
<section id="t-test-and-ks-test">
<h3>T-test and KS-test<a class="headerlink" href="#t-test-and-ks-test" title="Permalink to this headline">¶</a></h3>
<p>We can use the t-test to test whether the mean of our sample differs
in a statistically significant way from the theoretical expectation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t-statistic = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span>  <span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
<span class="go">t-statistic =  0.391 pvalue = 0.6955  # random</span>
</pre></div>
</div>
<p>The pvalue is 0.7, this means that with an alpha error of, for
example, 10%, we cannot reject the hypothesis that the sample mean
is equal to zero, the expectation of the standard t-distribution.</p>
<p>As an exercise, we can calculate our ttest also directly without
using the provided function, which should give us the same answer,
and so it does:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">sm</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sv</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>  <span class="c1"># t-statistic for mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tt</span><span class="p">),</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>  <span class="c1"># two-sided pvalue = Prob(abs(t)&gt;tt)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t-statistic = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">pval</span><span class="p">))</span>
<span class="go">t-statistic =  0.391 pvalue = 0.6955  # random</span>
</pre></div>
</div>
<p>The Kolmogorov-Smirnov test can be used to test the hypothesis that
the sample comes from the standard t-distribution</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KS-statistic D = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,)))</span>
<span class="go">KS-statistic D =  0.016 pvalue = 0.9571  # random</span>
</pre></div>
</div>
<p>Again, the p-value is high enough that we cannot reject the
hypothesis that the random sample really is distributed according to the
t-distribution. In real applications, we don’t know what the
underlying distribution is. If we perform the Kolmogorov-Smirnov
test of our sample against the standard normal distribution, then we
also cannot reject the hypothesis that our sample was generated by the
normal distribution given that, in this example, the p-value is almost 40%.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KS-statistic D = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">))</span>
<span class="go">KS-statistic D =  0.028 pvalue = 0.3918  # random</span>
</pre></div>
</div>
<p>However, the standard normal distribution has a variance of 1, while our
sample has a variance of 1.29. If we standardize our sample and test it
against the normal distribution, then the p-value is again large enough
that we cannot reject the hypothesis that the sample came form the
normal distribution.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KS-statistic D = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">pval</span><span class="p">))</span>
<span class="go">KS-statistic D =  0.032 pvalue = 0.2397  # random</span>
</pre></div>
</div>
<p>Note: The Kolmogorov-Smirnov test assumes that we test against a
distribution with given parameters, since, in the last case, we
estimated mean and variance, this assumption is violated and the
distribution of the test statistic, on which the p-value is based, is
not correct.</p>
</section>
<section id="tails-of-the-distribution">
<h3>Tails of the distribution<a class="headerlink" href="#tails-of-the-distribution" title="Permalink to this headline">¶</a></h3>
<p>Finally, we can check the upper tail of the distribution. We can use
the percent point function ppf, which is the inverse of the cdf
function, to obtain the critical values, or, more directly, we can use
the inverse of the survival function</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crit01</span><span class="p">,</span> <span class="n">crit05</span><span class="p">,</span> <span class="n">crit10</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.10</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;critical values from ppf at 1</span><span class="si">%%</span><span class="s1">, 5</span><span class="si">%%</span><span class="s1"> and 10</span><span class="si">%%</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">crit01</span><span class="p">,</span> <span class="n">crit05</span><span class="p">,</span> <span class="n">crit10</span><span class="p">))</span>
<span class="go">critical values from ppf at 1%, 5% and 10%   2.7638   1.8125   1.3722</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;critical values from isf at 1</span><span class="si">%%</span><span class="s1">, 5</span><span class="si">%%</span><span class="s1"> and 10</span><span class="si">%%</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.10</span><span class="p">],</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">critical values from isf at 1%, 5% and 10%   2.7638   1.8125   1.3722</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">freq01</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">crit01</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq05</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">crit05</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">crit10</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sample </span><span class="si">%%</span><span class="s1">-frequency at 1</span><span class="si">%%</span><span class="s1">, 5</span><span class="si">%%</span><span class="s1"> and 10</span><span class="si">%%</span><span class="s1"> tail </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">freq01</span><span class="p">,</span> <span class="n">freq05</span><span class="p">,</span> <span class="n">freq10</span><span class="p">))</span>
<span class="go">sample %-frequency at 1%, 5% and 10% tail   1.4000   5.8000  10.5000  # random</span>
</pre></div>
</div>
<p>In all three cases, our sample has more weight in the top tail than the
underlying distribution.
We can briefly check a larger sample to see if we get a closer match. In this
case, the empirical frequency is quite close to the theoretical probability,
but if we repeat this several times, the fluctuations are still pretty large.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">freq05l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">crit05</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10000.0</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;larger sample </span><span class="si">%%</span><span class="s1">-frequency at 5</span><span class="si">%%</span><span class="s1"> tail </span><span class="si">%8.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">freq05l</span><span class="p">)</span>
<span class="go">larger sample %-frequency at 5% tail   4.8000  # random</span>
</pre></div>
</div>
<p>We can also compare it with the tail of the normal distribution, which
has less weight in the tails:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tail prob. of normal at 1</span><span class="si">%%</span><span class="s1">, 5</span><span class="si">%%</span><span class="s1"> and 10</span><span class="si">%%</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1"> </span><span class="si">%8.4f</span><span class="s1">&#39;</span> <span class="o">%</span>
<span class="gp">... </span>      <span class="nb">tuple</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">([</span><span class="n">crit01</span><span class="p">,</span> <span class="n">crit05</span><span class="p">,</span> <span class="n">crit10</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="go">tail prob. of normal at 1%, 5% and 10%   0.2857   3.4957   8.5003</span>
</pre></div>
</div>
<p>The chisquare test can be used to test whether for a finite number of bins,
the observed frequencies differ significantly from the probabilities of the
hypothesized distribution.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quantiles</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.10</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">quantiles</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crit</span>
<span class="go">array([       -inf, -2.76376946, -1.81246112, -1.37218364,  1.37218364,</span>
<span class="go">        1.81246112,  2.76376946,         inf])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_sample</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">crit</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tprob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nprob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">crit</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tch</span><span class="p">,</span> <span class="n">tpval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">freqcount</span><span class="p">,</span> <span class="n">tprob</span><span class="o">*</span><span class="n">n_sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nch</span><span class="p">,</span> <span class="n">npval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">freqcount</span><span class="p">,</span> <span class="n">nprob</span><span class="o">*</span><span class="n">n_sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chisquare for t:      chi2 = </span><span class="si">%6.2f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tch</span><span class="p">,</span> <span class="n">tpval</span><span class="p">))</span>
<span class="go">chisquare for t:      chi2 =  2.30 pvalue = 0.8901  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chisquare for normal: chi2 = </span><span class="si">%6.2f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nch</span><span class="p">,</span> <span class="n">npval</span><span class="p">))</span>
<span class="go">chisquare for normal: chi2 = 64.60 pvalue = 0.0000  # random</span>
</pre></div>
</div>
<p>We see that the standard normal distribution is clearly rejected, while the
standard t-distribution cannot be rejected. Since the variance of our sample
differs from both standard distributions, we can again redo the test taking
the estimate for scale and location into account.</p>
<p>The fit method of the distributions can be used to estimate the parameters
of the distribution, and the test is repeated using probabilities of the
estimated distribution.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdof</span><span class="p">,</span> <span class="n">tloc</span><span class="p">,</span> <span class="n">tscale</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nloc</span><span class="p">,</span> <span class="n">nscale</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tprob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">crit</span><span class="p">,</span> <span class="n">tdof</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">tloc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">tscale</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nprob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">crit</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">nloc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">nscale</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tch</span><span class="p">,</span> <span class="n">tpval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">freqcount</span><span class="p">,</span> <span class="n">tprob</span><span class="o">*</span><span class="n">n_sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nch</span><span class="p">,</span> <span class="n">npval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">freqcount</span><span class="p">,</span> <span class="n">nprob</span><span class="o">*</span><span class="n">n_sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chisquare for t:      chi2 = </span><span class="si">%6.2f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tch</span><span class="p">,</span> <span class="n">tpval</span><span class="p">))</span>
<span class="go">chisquare for t:      chi2 =  1.58 pvalue = 0.9542  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chisquare for normal: chi2 = </span><span class="si">%6.2f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nch</span><span class="p">,</span> <span class="n">npval</span><span class="p">))</span>
<span class="go">chisquare for normal: chi2 = 11.08 pvalue = 0.0858  # random</span>
</pre></div>
</div>
<p>Taking account of the estimated parameters, we can still reject the
hypothesis that our sample came from a normal distribution (at the 5% level),
but again, with a p-value of 0.95, we cannot reject the t-distribution.</p>
</section>
<section id="special-tests-for-normal-distributions">
<h3>Special tests for normal distributions<a class="headerlink" href="#special-tests-for-normal-distributions" title="Permalink to this headline">¶</a></h3>
<p>Since the normal distribution is the most common distribution in statistics,
there are several additional functions available to test whether a sample
could have been drawn from a normal distribution.</p>
<p>First, we can test if skew and kurtosis of our sample differ significantly from
those of a normal distribution:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normal skewtest teststat = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">skewtest</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">normal skewtest teststat =  2.785 pvalue = 0.0054  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normal kurtosistest teststat = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">kurtosistest</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">normal kurtosistest teststat =  4.757 pvalue = 0.0000  # random</span>
</pre></div>
</div>
<p>These two tests are combined in the normality test</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normaltest teststat = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">normaltest teststat = 30.379 pvalue = 0.0000  # random</span>
</pre></div>
</div>
<p>In all three tests, the p-values are very low and we can reject the hypothesis
that the our sample has skew and kurtosis of the normal distribution.</p>
<p>Since skew and kurtosis of our sample are based on central moments, we get
exactly the same results if we test the standardized sample:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normaltest teststat = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span>
<span class="gp">... </span>      <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
<span class="go">normaltest teststat = 30.379 pvalue = 0.0000  # random</span>
</pre></div>
</div>
<p>Because normality is rejected so strongly, we can check whether the
normaltest gives reasonable results for other cases:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normaltest teststat = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span>
<span class="gp">... </span>      <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)))</span>
<span class="go">normaltest teststat =  4.698 pvalue = 0.0955  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normaltest teststat = </span><span class="si">%6.3f</span><span class="s1"> pvalue = </span><span class="si">%6.4f</span><span class="s1">&#39;</span> <span class="o">%</span>
<span class="gp">... </span>             <span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)))</span>
<span class="go">normaltest teststat =  0.613 pvalue = 0.7361  # random</span>
</pre></div>
</div>
<p>When testing for normality of a small sample of t-distributed observations
and a large sample of normal-distributed observations, then in neither case
can we reject the null hypothesis that the sample comes from a normal
distribution. In the first case, this is because the test is not powerful
enough to distinguish a t and a normally distributed random variable in a
small sample.</p>
</section>
</section>
<section id="comparing-two-samples">
<h2>Comparing two samples<a class="headerlink" href="#comparing-two-samples" title="Permalink to this headline">¶</a></h2>
<p>In the following, we are given two samples, which can come either from the
same or from different distribution, and we want to test whether these
samples have the same statistical properties.</p>
<section id="comparing-means">
<h3>Comparing means<a class="headerlink" href="#comparing-means" title="Permalink to this headline">¶</a></h3>
<p>Test with sample with identical means:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rvs1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rvs2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">rvs1</span><span class="p">,</span> <span class="n">rvs2</span><span class="p">)</span>
<span class="go">Ttest_indResult(statistic=-0.5489036175088705, pvalue=0.5831943748663959)  # random</span>
</pre></div>
</div>
<p>Test with sample with different means:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rvs3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">rvs1</span><span class="p">,</span> <span class="n">rvs3</span><span class="p">)</span>
<span class="go">Ttest_indResult(statistic=-4.533414290175026, pvalue=6.507128186389019e-06)  # random</span>
</pre></div>
</div>
</section>
<section id="kolmogorov-smirnov-test-for-two-samples-ks-2samp">
<h3>Kolmogorov-Smirnov test for two samples ks_2samp<a class="headerlink" href="#kolmogorov-smirnov-test-for-two-samples-ks-2samp" title="Permalink to this headline">¶</a></h3>
<p>For the example, where both samples are drawn from the same distribution,
we cannot reject the null hypothesis, since the pvalue is high</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ks_2samp</span><span class="p">(</span><span class="n">rvs1</span><span class="p">,</span> <span class="n">rvs2</span><span class="p">)</span>
<span class="go">KstestResult(statistic=0.026, pvalue=0.9959527565364388)  # random</span>
</pre></div>
</div>
<p>In the second example, with different location, i.e., means, we can
reject the null hypothesis, since the pvalue is below 1%</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ks_2samp</span><span class="p">(</span><span class="n">rvs1</span><span class="p">,</span> <span class="n">rvs3</span><span class="p">)</span>
<span class="go">KstestResult(statistic=0.114, pvalue=0.00299005061044668)  # random</span>
</pre></div>
</div>
</section>
</section>
<section id="kernel-density-estimation">
<h2>Kernel density estimation<a class="headerlink" href="#kernel-density-estimation" title="Permalink to this headline">¶</a></h2>
<p>A common task in statistics is to estimate the probability density function
(PDF) of a random variable from a set of data samples. This task is called
density estimation. The most well-known tool to do this is the histogram.
A histogram is a useful tool for visualization (mainly because everyone
understands it), but doesn’t use the available data very efficiently. Kernel
density estimation (KDE) is a more efficient tool for the same task. The
<a class="reference internal" href="../reference/generated/scipy.stats.gaussian_kde.html#scipy.stats.gaussian_kde" title="scipy.stats.gaussian_kde"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian_kde</span></code></a> estimator can be used to estimate the PDF of univariate as
well as multivariate data. It works best if the data is unimodal.</p>
<section id="univariate-estimation">
<h3>Univariate estimation<a class="headerlink" href="#univariate-estimation" title="Permalink to this headline">¶</a></h3>
<p>We start with a minimal amount of data in order to see how <a class="reference internal" href="../reference/generated/scipy.stats.gaussian_kde.html#scipy.stats.gaussian_kde" title="scipy.stats.gaussian_kde"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian_kde</span></code></a>
works and what the different options for bandwidth selection do. The data
sampled from the PDF are shown as blue dashes at the bottom of the figure (this
is called a rug plot):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kde1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kde2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="s1">&#39;silverman&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s1">&#39;b+&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># rug plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde1</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scott&#39;s Rule&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde2</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Silverman&#39;s Rule&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/stats-1.png" class="plot-directive" src="../_images/stats-1.png" />
</figure>
<p>We see that there is very little difference between Scott’s Rule and
Silverman’s Rule, and that the bandwidth selection with a limited amount of
data is probably a bit too wide. We can define our own bandwidth function to
get a less smoothed-out result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_kde_bandwidth</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;We use Scott&#39;s Rule, multiplied by a constant factor.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">d</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span> <span class="o">*</span> <span class="n">fac</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s1">&#39;b+&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># rug plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kde3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="n">my_kde_bandwidth</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde3</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;With smaller BW&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/kde_plot2.png" class="plot-directive" src="../_images/kde_plot2.png" />
</figure>
<p>We see that if we set bandwidth to be very narrow, the obtained estimate for
the probability density function (PDF) is simply the sum of Gaussians around
each data point.</p>
<p>We now take a more realistic example and look at the difference between the
two available bandwidth selection rules. Those rules are known to work well
for (close to) normal distributions, but even for unimodal distributions that
are quite strongly non-normal they work reasonably well. As a non-normal
distribution we take a Student’s T distribution with 5 degrees of freedom.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>


<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>  <span class="c1"># random data, normal distribution</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">kde1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">kde2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="s1">&#39;silverman&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s1">&#39;b+&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>  <span class="c1"># rug plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">kde1</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scott&#39;s Rule&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">kde2</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Silverman&#39;s Rule&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True PDF&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Normal (top) and Student&#39;s T$_{df=5}$ (bottom) distributions&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>  <span class="c1"># random data, T distribution</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">kde3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="n">kde4</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="s1">&#39;silverman&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s1">&#39;b+&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>  <span class="c1"># rug plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">kde3</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scott&#39;s Rule&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">kde4</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Silverman&#39;s Rule&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True PDF&quot;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/kde_plot3.png" class="plot-directive" src="../_images/kde_plot3.png" />
</figure>
<p>We now take a look at a bimodal distribution with one wider and one narrower
Gaussian feature. We expect that this will be a more difficult density to
approximate, due to the different bandwidths required to accurately resolve
each feature.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span><span class="p">,</span> <span class="n">size1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">175</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc2</span><span class="p">,</span> <span class="n">scale2</span><span class="p">,</span> <span class="n">size2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size1</span><span class="p">),</span>
<span class="gp">... </span>                     <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size2</span><span class="p">)])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kde</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kde2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="s1">&#39;silverman&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kde3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">my_kde_bandwidth</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kde4</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">my_kde_bandwidth</span><span class="p">,</span> <span class="n">fac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bimodal_pdf</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">size1</span><span class="p">)</span> <span class="o">/</span> <span class="n">x2</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> \
<span class="gp">... </span>              <span class="n">pdf</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">size2</span><span class="p">)</span> <span class="o">/</span> <span class="n">x2</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s1">&#39;b+&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scott&#39;s Rule&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde2</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Silverman&#39;s Rule&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde3</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scott * 0.2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">kde4</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scott * 0.5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">bimodal_pdf</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual PDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">x_eval</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x_eval</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/kde_plot4.png" class="plot-directive" src="../_images/kde_plot4.png" />
</figure>
<p>As expected, the KDE is not as close to the true PDF as we would like due to
the different characteristic size of the two features of the bimodal
distribution. By halving the default bandwidth (<code class="docutils literal notranslate"><span class="pre">Scott</span> <span class="pre">*</span> <span class="pre">0.5</span></code>), we can do
somewhat better, while using a factor 5 smaller bandwidth than the default
doesn’t smooth enough. What we really need, though, in this case, is a
non-uniform (adaptive) bandwidth.</p>
</section>
<section id="multivariate-estimation">
<h3>Multivariate estimation<a class="headerlink" href="#multivariate-estimation" title="Permalink to this headline">¶</a></h3>
<p>With <a class="reference internal" href="../reference/generated/scipy.stats.gaussian_kde.html#scipy.stats.gaussian_kde" title="scipy.stats.gaussian_kde"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian_kde</span></code></a> we can perform multivariate, as well as univariate
estimation. We demonstrate the bivariate case. First, we generate some random
data with a model in which the two variates are correlated.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Measurement model, return two coupled measurements.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">m1</span><span class="o">+</span><span class="n">m2</span><span class="p">,</span> <span class="n">m1</span><span class="o">-</span><span class="n">m2</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">measure</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xmin</span> <span class="o">=</span> <span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xmax</span> <span class="o">=</span> <span class="n">m1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ymin</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ymax</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<p>Then we apply the KDE to the data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">xmin</span><span class="p">:</span><span class="n">xmax</span><span class="p">:</span><span class="mi">100</span><span class="n">j</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="n">ymax</span><span class="p">:</span><span class="mi">100</span><span class="n">j</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we plot the estimated bivariate distribution as a colormap and plot
the individual data points on top.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">Z</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gist_earth_r</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/kde_plot5.png" class="plot-directive" src="../_images/kde_plot5.png" />
</figure>
</section>
<section id="multiscale-graph-correlation-mgc">
<h3>Multiscale Graph Correlation (MGC)<a class="headerlink" href="#multiscale-graph-correlation-mgc" title="Permalink to this headline">¶</a></h3>
<p>With <a class="reference internal" href="../reference/generated/scipy.stats.multiscale_graphcorr.html#scipy.stats.multiscale_graphcorr" title="scipy.stats.multiscale_graphcorr"><code class="xref py py-func docutils literal notranslate"><span class="pre">multiscale_graphcorr</span></code></a>, we can test for independence on high
dimensional and nonlinear data. Before we start, let’s import some useful
packages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span><span class="p">;</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multiscale_graphcorr</span>
</pre></div>
</div>
<p>Let’s use a custom plotting function to plot the data relationship:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">mgc_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sim_name</span><span class="p">,</span> <span class="n">mgc_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">only_viz</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">only_mgc</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Plot sim and MGC-plot&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">only_mgc</span><span class="p">:</span>
<span class="gp">... </span>        <span class="c1"># simulation</span>
<span class="gp">... </span>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">sim_name</span> <span class="o">+</span> <span class="s2">&quot; Simulation&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">only_viz</span><span class="p">:</span>
<span class="gp">... </span>        <span class="c1"># local correlation map</span>
<span class="gp">... </span>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">mgc_map</span> <span class="o">=</span> <span class="n">mgc_dict</span><span class="p">[</span><span class="s2">&quot;mgc_map&quot;</span><span class="p">]</span>
<span class="gp">... </span>        <span class="c1"># draw heatmap</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Local Correlation Map&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mgc_map</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="c1"># colorbar</span>
<span class="gp">... </span>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="gp">... </span>        <span class="c1"># Turn spines off and create white grid.</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">edge</span><span class="p">,</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>            <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>        <span class="c1"># optimal scale</span>
<span class="gp">... </span>        <span class="n">opt_scale</span> <span class="o">=</span> <span class="n">mgc_dict</span><span class="p">[</span><span class="s2">&quot;opt_scale&quot;</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">opt_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_scale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="c1"># other formatting</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;#Neighbors for X&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;#Neighbors for Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Let’s look at some linear data first:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>The simulation relationship can be plotted below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mgc_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="n">only_viz</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/mgc_plot1_01_00.png" class="plot-directive" src="../_images/mgc_plot1_01_00.png" />
</figure>
<p>Now, we can see the test statistic, p-value, and MGC map visualized below. The
optimal scale is shown on the map as a red “x”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">mgc_dict</span> <span class="o">=</span> <span class="n">multiscale_graphcorr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MGC test statistic: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">MGC test statistic:  1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P-value: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">pvalue</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">P-value:  0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mgc_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="n">mgc_dict</span><span class="p">,</span> <span class="n">only_mgc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/mgc_plot2.png" class="plot-directive" src="../_images/mgc_plot2.png" />
</figure>
<p>It is clear from here, that MGC is able to determine a relationship between the
input data matrices because the p-value is very low and the MGC test statistic
is relatively high. The MGC-map indicates a <strong>strongly linear relationship</strong>.
Intuitively, this is because having more neighbors will help in identifying a
linear relationship between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. The optimal scale in this
case is <strong>equivalent to the global scale</strong>, marked by a red spot on the map.</p>
<p>The same can be done for nonlinear data sets. The following <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(y\)</span> arrays are derived from a nonlinear simulation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unif</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">unif</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">unif</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">unif</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">unif</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>The simulation relationship can be plotted below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mgc_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="n">only_viz</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/mgc_plot3_01_00.png" class="plot-directive" src="../_images/mgc_plot3_01_00.png" />
</figure>
<p>Now, we can see the test statistic, p-value, and MGC map visualized below. The
optimal scale is shown on the map as a red “x”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">mgc_dict</span> <span class="o">=</span> <span class="n">multiscale_graphcorr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MGC test statistic: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">MGC test statistic:  0.2  # random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P-value: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">pvalue</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">P-value:  0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mgc_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;Spiral&quot;</span><span class="p">,</span> <span class="n">mgc_dict</span><span class="p">,</span> <span class="n">only_mgc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/mgc_plot4.png" class="plot-directive" src="../_images/mgc_plot4.png" />
</figure>
<p>It is clear from here, that MGC is able to determine a relationship again
because the p-value is very low and the MGC test statistic is relatively high.
The MGC-map indicates a <strong>strongly nonlinear relationship</strong>. The optimal scale
in this case is <strong>equivalent to the local scale</strong>, marked by a red spot on the
map.</p>
</section>
</section>
<section id="quasi-monte-carlo">
<h2>Quasi-Monte Carlo<a class="headerlink" href="#quasi-monte-carlo" title="Permalink to this headline">¶</a></h2>
<p>Before talking about Quasi-Monte Carlo (QMC), a quick introduction about Monte
Carlo (MC). MC methods, or MC experiments, are a broad class of
computational algorithms that rely on repeated random sampling to obtain
numerical results. The underlying concept is to use randomness to solve
problems that might be deterministic in principle. They are often used in
physical and mathematical problems and are most useful when it is difficult or
impossible to use other approaches. MC methods are mainly used in
three problem classes: optimization, numerical integration, and generating
draws from a probability distribution.</p>
<p>Generating random numbers with specific properties is a more complex problem
than it sounds. Simple MC methods are designed to sample points to be
independent and identically distributed (IID). But generating multiple sets
of random points can produce radically different results.</p>
<figure class="align-center">
<img alt="../_images/qmc_plot_mc.png" class="plot-directive" src="../_images/qmc_plot_mc.png" />
</figure>
<p>In both cases in the plot above, points are generated randomly without any
knowledge about previously drawn points. It is clear that some regions of
the space are left unexplored - which can cause problems in simulations as a
particular set of points might trigger a totally different behaviour.</p>
<p>A great benefit of MC is that it has known convergence properties.
Let’s look at the mean of the squared sum in 5 dimensions:</p>
<div class="math notranslate nohighlight">
\[f(\mathbf{x}) = \left( \sum_{j=1}^{5}x_j \right)^2,\]</div>
<p>with <span class="math notranslate nohighlight">\(x_j \sim \mathcal{U}(0,1)\)</span>. It has a known mean value,
<span class="math notranslate nohighlight">\(\mu = 5/3+5(5-1)/4\)</span>. Using MC sampling, we
can compute that mean numerically, and the approximation error follows a
theoretical rate of <span class="math notranslate nohighlight">\(O(n^{-1/2})\)</span>.</p>
<figure class="align-center">
<img alt="../_images/qmc_plot_conv_mc.png" class="plot-directive" src="../_images/qmc_plot_conv_mc.png" />
</figure>
<p>Although the convergence is ensured, practitioners tend to want to have an
exploration process which is more deterministic. With normal MC, a seed can be
used to have a repeatable process. But fixing the seed would break the
convergence property: a given seed could work for a given class of problem
and break for another one.</p>
<p>What is commonly done to walk through the space in a deterministic manner, is
to use a regular grid spanning all parameter dimensions, also called a
saturated design. Let’s consider the unit-hypercube, with all bounds ranging
from 0 to 1. Now, having a distance of 0.1 between points, the number of points
required to fill the unit interval would be 10. In a 2-dimensional hypercube
the same spacing would require 100, and in 3 dimensions 1,000 points. As the
number of dimensions grows, the number of experiments which is required to fill
the space rises exponentially as the dimensionality of the space increases.
This exponential growth is called “the curse of dimensionality”.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disc</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">disc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">disc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">disc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/qmc_plot_curse.png" class="plot-directive" src="../_images/qmc_plot_curse.png" />
</figure>
<p>To mitigate this issue, QMC methods have been designed. They are
deterministic, have a good coverage of the space and some of them can be
continued and retain good properties.
The main difference with MC methods is that the points are not IID but they
know about previous points. Hence, some methods are also referred to as
sequences.</p>
<figure class="align-center">
<img alt="../_images/qmc_plot_mc_qmc.png" class="plot-directive" src="../_images/qmc_plot_mc_qmc.png" />
</figure>
<p>This figure presents 2 sets of 256 points. The design of the left is a plain
MC whereas the design of the right is a QMC design using the <em>Sobol’</em> method.
We clearly see that the QMC version is more uniform. The points sample better
near the boundaries and there are less clusters or gaps.</p>
<p>One way to assess the uniformity is to use a measure called the discrepancy.
Here the discrepancy of <em>Sobol’</em> points is better than crude MC.</p>
<p>Coming back to the computation of the mean, QMC methods also have better rates
of convergence for the error. They can achieve <span class="math notranslate nohighlight">\(O(n^{-1})\)</span> for this
function, and even better rates on very smooth functions. This figure shows
that the <em>Sobol’</em> method has a rate of <span class="math notranslate nohighlight">\(O(n^{-1})\)</span>:</p>
<figure class="align-center">
<img alt="../_images/qmc_plot_conv_mc_sobol.png" class="plot-directive" src="../_images/qmc_plot_conv_mc_sobol.png" />
</figure>
<p>We refer to the documentation of <a class="reference internal" href="../reference/stats.qmc.html#module-scipy.stats.qmc" title="scipy.stats.qmc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats.qmc</span></code></a> for
more mathematical details.</p>
<section id="calculate-the-discrepancy">
<h3>Calculate the discrepancy<a class="headerlink" href="#calculate-the-discrepancy" title="Permalink to this headline">¶</a></h3>
<p>Let’s consider two sets of points. From the figure below, it is clear that
the design on the left covers more of the space than the design on the right.
This can be quantified using a <a class="reference internal" href="../reference/generated/scipy.stats.qmc.discrepancy.html#scipy.stats.qmc.discrepancy" title="scipy.stats.qmc.discrepancy"><code class="xref py py-func docutils literal notranslate"><span class="pre">discrepancy</span></code></a> measure.
The lower the discrepancy, the more uniform a sample is.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">qmc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space_1</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">space_1</span><span class="p">,</span> <span class="n">l_bounds</span><span class="p">,</span> <span class="n">u_bounds</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space_2</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">space_2</span><span class="p">,</span> <span class="n">l_bounds</span><span class="p">,</span> <span class="n">u_bounds</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmc</span><span class="o">.</span><span class="n">discrepancy</span><span class="p">(</span><span class="n">space_1</span><span class="p">)</span>
<span class="go">0.008142039609053464</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmc</span><span class="o">.</span><span class="n">discrepancy</span><span class="p">(</span><span class="n">space_2</span><span class="p">)</span>
<span class="go">0.010456854423869011</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/qmc_plot_discrepancy.png" class="plot-directive" src="../_images/qmc_plot_discrepancy.png" />
</figure>
</section>
<section id="using-a-qmc-engine">
<h3>Using a QMC engine<a class="headerlink" href="#using-a-qmc-engine" title="Permalink to this headline">¶</a></h3>
<p>Several QMC samplers/engines are implemented. Here we look at two of the most
used QMC methods: <a class="reference internal" href="../reference/generated/scipy.stats.qmc.Sobol.html#scipy.stats.qmc.Sobol" title="scipy.stats.qmc.Sobol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobol</span></code></a> and <a class="reference internal" href="../reference/generated/scipy.stats.qmc.Halton.html#scipy.stats.qmc.Halton" title="scipy.stats.qmc.Halton"><code class="xref py py-class docutils literal notranslate"><span class="pre">Halton</span></code></a>
sequences.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Sobol&#39; and Halton sequences.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">qmc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>

<span class="n">n_sample</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">sample</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Sobol&#39;</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">Sobol</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">sample</span><span class="p">[</span><span class="s2">&quot;Sobol&#39;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)</span>

<span class="c1"># Halton</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">Halton</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">sample</span><span class="p">[</span><span class="s2">&quot;Halton&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n_sample</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">kind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">kind</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sample</span><span class="p">[</span><span class="n">kind</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s1">—$C^2 = $</span><span class="si">{</span><span class="n">qmc</span><span class="o">.</span><span class="n">discrepancy</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">kind</span><span class="p">])</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="../_images/qmc_plot_sobol_halton.png" class="plot-directive" src="../_images/qmc_plot_sobol_halton.png" />
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>QMC methods require particular care and the user must read the
documentation to avoid common pitfalls. <em>Sobol’</em> for instance requires a
number of points following a power of 2. Also, thinning, burning or other
point selection can break the properties of the sequence and result in a
set of points which would not be better than MC.</p>
</div>
<p>QMC engines are state-aware. Meaning that you can continue the sequence,
skip some points, or reset it. Let’s take 5 points from
<a class="reference internal" href="../reference/generated/scipy.stats.qmc.Halton.html#scipy.stats.qmc.Halton" title="scipy.stats.qmc.Halton"><code class="xref py py-class docutils literal notranslate"><span class="pre">Halton</span></code></a>. And then ask for a second set of 5 points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">qmc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">Halton</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[0.22166437, 0.07980522],  # random</span>
<span class="go">       [0.72166437, 0.93165708],</span>
<span class="go">       [0.47166437, 0.41313856],</span>
<span class="go">       [0.97166437, 0.19091633],</span>
<span class="go">       [0.01853937, 0.74647189]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[0.51853937, 0.52424967],  # random</span>
<span class="go">       [0.26853937, 0.30202745],</span>
<span class="go">       [0.76853937, 0.857583  ],</span>
<span class="go">       [0.14353937, 0.63536078],</span>
<span class="go">       [0.64353937, 0.01807683]])</span>
</pre></div>
</div>
<p>Now we reset the sequence. Asking for 5 points leads to the same first 5
points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[0.22166437, 0.07980522],  # random</span>
<span class="go">       [0.72166437, 0.93165708],</span>
<span class="go">       [0.47166437, 0.41313856],</span>
<span class="go">       [0.97166437, 0.19091633],</span>
<span class="go">       [0.01853937, 0.74647189]])</span>
</pre></div>
</div>
<p>And here we advance the sequence to get the same second set of 5 points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">fast_forward</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[0.51853937, 0.52424967],  # random</span>
<span class="go">       [0.26853937, 0.30202745],</span>
<span class="go">       [0.76853937, 0.857583  ],</span>
<span class="go">       [0.14353937, 0.63536078],</span>
<span class="go">       [0.64353937, 0.01807683]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, both <a class="reference internal" href="../reference/generated/scipy.stats.qmc.Sobol.html#scipy.stats.qmc.Sobol" title="scipy.stats.qmc.Sobol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobol</span></code></a> and
<a class="reference internal" href="../reference/generated/scipy.stats.qmc.Halton.html#scipy.stats.qmc.Halton" title="scipy.stats.qmc.Halton"><code class="xref py py-class docutils literal notranslate"><span class="pre">Halton</span></code></a> are scrambled. The convergence properties are
better, and it prevents the appearance of fringes or noticeable patterns
of points in high dimensions. There should be no practical reason not to
use the scrambled version.</p>
</div>
</section>
<section id="making-a-qmc-engine-i-e-subclassing-qmcengine">
<h3>Making a QMC engine, i.e., subclassing <code class="docutils literal notranslate"><span class="pre">QMCEngine</span></code><a class="headerlink" href="#making-a-qmc-engine-i-e-subclassing-qmcengine" title="Permalink to this headline">¶</a></h3>
<p>To make your own <a class="reference internal" href="../reference/generated/scipy.stats.qmc.QMCEngine.html#scipy.stats.qmc.QMCEngine" title="scipy.stats.qmc.QMCEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">QMCEngine</span></code></a>, a few methods have to be
defined. Following is an example wrapping <a class="reference external" href="https://numpy.org/devdocs/reference/random/generator.html#numpy.random.Generator" title="(in NumPy v1.21.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">qmc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">RandomEngine</span><span class="p">(</span><span class="n">qmc</span><span class="o">.</span><span class="n">QMCEngine</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rng_seed</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_generated</span> <span class="o">+=</span> <span class="n">n</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rng_seed</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_generated</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">fast_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span>
</pre></div>
</div>
<p>Then we use it as any other QMC engine:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">RandomEngine</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[0.22733602, 0.31675834],  # random</span>
<span class="go">       [0.79736546, 0.67625467],</span>
<span class="go">       [0.39110955, 0.33281393],</span>
<span class="go">       [0.59830875, 0.18673419],</span>
<span class="go">       [0.67275604, 0.94180287]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[0.22733602, 0.31675834],  # random</span>
<span class="go">       [0.79736546, 0.67625467],</span>
<span class="go">       [0.39110955, 0.33281393],</span>
<span class="go">       [0.59830875, 0.18673419],</span>
<span class="go">       [0.67275604, 0.94180287]])</span>
</pre></div>
</div>
</section>
<section id="guidelines-on-using-qmc">
<h3>Guidelines on using QMC<a class="headerlink" href="#guidelines-on-using-qmc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>QMC has rules! Be sure to read the documentation or you might have no
benefit over MC.</p></li>
<li><p>Use <a class="reference internal" href="../reference/generated/scipy.stats.qmc.Sobol.html#scipy.stats.qmc.Sobol" title="scipy.stats.qmc.Sobol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sobol</span></code></a> if you need <strong>exactly</strong> <span class="math notranslate nohighlight">\(2^m\)</span> points.</p></li>
<li><p><a class="reference internal" href="../reference/generated/scipy.stats.qmc.Halton.html#scipy.stats.qmc.Halton" title="scipy.stats.qmc.Halton"><code class="xref py py-class docutils literal notranslate"><span class="pre">Halton</span></code></a> allows to sample, or skip, an arbitrary number of
points. This is at the cost of a slower rate of convergence than <em>Sobol’</em>.</p></li>
<li><p>Never remove the first points of the sequence. It will destroy the
properties.</p></li>
<li><p>Scrambling is always better.</p></li>
<li><p>If you use LHS based methods, you cannot add points without losing the LHS
properties. (There are some methods to do so, but this is not implemented.)</p></li>
</ul>
</section>
</section>
</section>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="spatial.html" title="previous page">Spatial data structures and algorithms (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.spatial</span></code>)</a>
    <a class='right-next' id="next-link" href="stats/discrete.html" title="next page">Discrete Statistical Distributions</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2008-2021, The SciPy community.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>