
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shgo &#8212; SciPy v1.15.0.dev Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyterlite_sphinx.css?v=ca70e7f1" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css?v=6dd54bfa" />
    <link rel="stylesheet" type="text/css" href="../../_static/try_examples.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=3d29109c"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=fe3c738c"></script>
    <script src="../../_static/jupyterlite_sphinx.js?v=d6bdf5f8"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script data-domain="docs.scipy.org" defer="defer" src="https://views.scientific-python.org/js/script.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/scipy.optimize.shgo';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scipy.github.io/devdocs/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'development';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dual_annealing" href="scipy.optimize.dual_annealing.html" />
    <link rel="prev" title="differential_evolution" href="scipy.optimize.differential_evolution.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.15.0.dev" />
    <meta name="docbuild:last-update" content="Oct 24, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt=""/>
    <img src="../../_static/logo.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">SciPy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipy.org/install/">
    Installing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorial/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../building/index.html">
    Building from source
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipy/scipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/SciPy_team" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scipy.org/install/">
    Installing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorial/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../building/index.html">
    Building from source
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipy/scipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/SciPy_team" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links" aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../main_namespace.html">scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cluster.html">scipy.cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../constants.html">scipy.constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">scipy.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../differentiate.html">scipy.differentiate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fft.html">scipy.fft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fftpack.html">scipy.fftpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrate.html">scipy.integrate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpolate.html">scipy.interpolate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">scipy.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linalg.html">scipy.linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">scipy.misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ndimage.html">scipy.ndimage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odr.html">scipy.odr</a></li>
<li class="toctree-l1 current active"><a class="reference internal" href="../optimize.html">scipy.optimize</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal.html">scipy.signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparse.html">scipy.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spatial.html">scipy.spatial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special.html">scipy.special</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stats.html">scipy.stats</a></li>
</ul>

  </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">SciPy API</a></li>
    
    
    <li class="breadcrumb-item"><a href="../optimize.html" class="nav-link">Optimization and root finding (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code>)</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">shgo</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="prename">scipy.optimize.</div>
<div class="empty"></div><section id="shgo">
<h1>shgo<a class="headerlink" href="#shgo" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="scipy.optimize.shgo">
<span class="sig-prename descclassname"><span class="pre">scipy.optimize.</span></span><span class="sig-name descname"><span class="pre">shgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimizer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simplicial'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/main/scipy/optimize/_shgo.py#L22-L485"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scipy.optimize.shgo" title="Link to this definition">#</a></dt>
<dd><p>Finds the global minimum of a function using SHG optimization.</p>
<p>SHGO stands for “simplicial homology global optimization”.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>func</strong><span class="classifier">callable</span></dt><dd><p>The objective function to be minimized.  Must be in the form
<code class="docutils literal notranslate"><span class="pre">f(x,</span> <span class="pre">*args)</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is the argument in the form of a 1-D array
and <code class="docutils literal notranslate"><span class="pre">args</span></code> is a tuple of any additional fixed parameters needed to
completely specify the function.</p>
</dd>
<dt><strong>bounds</strong><span class="classifier">sequence or <a class="reference internal" href="scipy.optimize.Bounds.html#scipy.optimize.Bounds" title="scipy.optimize.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a></span></dt><dd><p>Bounds for variables. There are two ways to specify the bounds:</p>
<ol class="arabic simple">
<li><p>Instance of <a class="reference internal" href="scipy.optimize.Bounds.html#scipy.optimize.Bounds" title="scipy.optimize.Bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bounds</span></code></a> class.</p></li>
<li><p>Sequence of <code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> pairs for each element in <em class="xref py py-obj">x</em>.</p></li>
</ol>
</dd>
<dt><strong>args</strong><span class="classifier">tuple, optional</span></dt><dd><p>Any additional fixed parameters needed to completely specify the
objective function.</p>
</dd>
<dt><strong>constraints</strong><span class="classifier">{Constraint, dict} or List of {Constraint, dict}, optional</span></dt><dd><p>Constraints definition. Only for COBYLA, COBYQA, SLSQP and trust-constr.
See the tutorial <a class="reference internal" href="#rb2e152d227b3-5" id="id1">[5]</a> for further details on specifying constraints.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only COBYLA, COBYQA, SLSQP, and trust-constr local minimize methods
currently support constraint arguments. If the <code class="docutils literal notranslate"><span class="pre">constraints</span></code>
sequence used in the local optimization problem is not defined in
<code class="docutils literal notranslate"><span class="pre">minimizer_kwargs</span></code> and a constrained method is used then the
global <code class="docutils literal notranslate"><span class="pre">constraints</span></code> will be used.
(Defining a <code class="docutils literal notranslate"><span class="pre">constraints</span></code> sequence in <code class="docutils literal notranslate"><span class="pre">minimizer_kwargs</span></code>
means that <code class="docutils literal notranslate"><span class="pre">constraints</span></code> will not be added so if equality
constraints and so forth need to be added then the inequality
functions in <code class="docutils literal notranslate"><span class="pre">constraints</span></code> need to be added to
<code class="docutils literal notranslate"><span class="pre">minimizer_kwargs</span></code> too).
COBYLA only supports inequality constraints.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.11.0: </span><code class="docutils literal notranslate"><span class="pre">constraints</span></code> accepts <a class="reference internal" href="scipy.optimize.NonlinearConstraint.html#scipy.optimize.NonlinearConstraint" title="scipy.optimize.NonlinearConstraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NonlinearConstraint</span></code></a>, <a class="reference internal" href="scipy.optimize.LinearConstraint.html#scipy.optimize.LinearConstraint" title="scipy.optimize.LinearConstraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinearConstraint</span></code></a>.</p>
</div>
</dd>
<dt><strong>n</strong><span class="classifier">int, optional</span></dt><dd><p>Number of sampling points used in the construction of the simplicial
complex. For the default <code class="docutils literal notranslate"><span class="pre">simplicial</span></code> sampling method 2**dim + 1
sampling points are generated instead of the default <code class="docutils literal notranslate"><span class="pre">n=100</span></code>. For all
other specified values <em class="xref py py-obj">n</em> sampling points are generated. For
<code class="docutils literal notranslate"><span class="pre">sobol</span></code>, <code class="docutils literal notranslate"><span class="pre">halton</span></code> and other arbitrary <em class="xref py py-obj">sampling_methods</em> <code class="docutils literal notranslate"><span class="pre">n=100</span></code> or
another specified number of sampling points are generated.</p>
</dd>
<dt><strong>iters</strong><span class="classifier">int, optional</span></dt><dd><p>Number of iterations used in the construction of the simplicial
complex. Default is 1.</p>
</dd>
<dt><strong>callback</strong><span class="classifier">callable, optional</span></dt><dd><p>Called after each iteration, as <code class="docutils literal notranslate"><span class="pre">callback(xk)</span></code>, where <code class="docutils literal notranslate"><span class="pre">xk</span></code> is the
current parameter vector.</p>
</dd>
<dt><strong>minimizer_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Extra keyword arguments to be passed to the minimizer
<code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. Some important options could be:</p>
<dl class="simple">
<dt>method<span class="classifier">str</span></dt><dd><p>The minimization method. If not given, chosen to be one of
BFGS, L-BFGS-B, SLSQP, depending on whether or not the
problem has constraints or bounds.</p>
</dd>
<dt>args<span class="classifier">tuple</span></dt><dd><p>Extra arguments passed to the objective function (<code class="docutils literal notranslate"><span class="pre">func</span></code>) and
its derivatives (Jacobian, Hessian).</p>
</dd>
<dt>options<span class="classifier">dict, optional</span></dt><dd><p>Note that by default the tolerance is specified as
<code class="docutils literal notranslate"><span class="pre">{ftol:</span> <span class="pre">1e-12}</span></code></p>
</dd>
</dl>
</dd>
<dt><strong>options</strong><span class="classifier">dict, optional</span></dt><dd><p>A dictionary of solver options. Many of the options specified for the
global routine are also passed to the <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>
routine. The options that are also passed to the local routine are
marked with “(L)”.</p>
<p>Stopping criteria, the algorithm will terminate if any of the specified
criteria are met. However, the default algorithm does not require any
to be specified:</p>
<dl class="simple">
<dt>maxfev<span class="classifier">int (L)</span></dt><dd><p>Maximum number of function evaluations in the feasible domain.
(Note only methods that support this option will terminate
the routine at precisely exact specified value. Otherwise the
criterion will only terminate during a global iteration)</p>
</dd>
<dt>f_min<span class="classifier">float</span></dt><dd><p>Specify the minimum objective function value, if it is known.</p>
</dd>
<dt>f_tol<span class="classifier">float</span></dt><dd><p>Precision goal for the value of f in the stopping
criterion. Note that the global routine will also
terminate if a sampling point in the global routine is
within this tolerance.</p>
</dd>
<dt>maxiter<span class="classifier">int</span></dt><dd><p>Maximum number of iterations to perform.</p>
</dd>
<dt>maxev<span class="classifier">int</span></dt><dd><p>Maximum number of sampling evaluations to perform (includes
searching in infeasible points).</p>
</dd>
<dt>maxtime<span class="classifier">float</span></dt><dd><p>Maximum processing runtime allowed</p>
</dd>
<dt>minhgrd<span class="classifier">int</span></dt><dd><p>Minimum homology group rank differential. The homology group of the
objective function is calculated (approximately) during every
iteration. The rank of this group has a one-to-one correspondence
with the number of locally convex subdomains in the objective
function (after adequate sampling points each of these subdomains
contain a unique global minimum). If the difference in the hgr is 0
between iterations for <code class="docutils literal notranslate"><span class="pre">maxhgrd</span></code> specified iterations the
algorithm will terminate.</p>
</dd>
</dl>
<p>Objective function knowledge:</p>
<dl>
<dt>symmetry<span class="classifier">list or bool</span></dt><dd><p>Specify if the objective function contains symmetric variables.
The search space (and therefore performance) is decreased by up to
O(n!) times in the fully symmetric case. If <em class="xref py py-obj">True</em> is specified
then all variables will be set symmetric to the first variable.
Default
is set to False.</p>
<p>E.g.  f(x) = (x_1 + x_2 + x_3) + (x_4)**2 + (x_5)**2 + (x_6)**2</p>
<p>In this equation x_2 and x_3 are symmetric to x_1, while x_5 and
x_6 are symmetric to x_4, this can be specified to the solver as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">symmetry</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Variable 1</span>
            <span class="mi">0</span><span class="p">,</span>  <span class="c1"># symmetric to variable 1</span>
            <span class="mi">0</span><span class="p">,</span>  <span class="c1"># symmetric to variable 1</span>
            <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Variable 4</span>
            <span class="mi">3</span><span class="p">,</span>  <span class="c1"># symmetric to variable 4</span>
            <span class="mi">3</span><span class="p">,</span>  <span class="c1"># symmetric to variable 4</span>
            <span class="p">]</span>
</pre></div>
</div>
</dd>
<dt>jac<span class="classifier">bool or callable, optional</span></dt><dd><p>Jacobian (gradient) of objective function. Only for CG, BFGS,
Newton-CG, L-BFGS-B, TNC, SLSQP, dogleg, trust-ncg. If <code class="docutils literal notranslate"><span class="pre">jac</span></code> is a
boolean and is True, <code class="docutils literal notranslate"><span class="pre">fun</span></code> is assumed to return the gradient
along with the objective function. If False, the gradient will be
estimated numerically. <code class="docutils literal notranslate"><span class="pre">jac</span></code> can also be a callable returning the
gradient of the objective. In this case, it must accept the same
arguments as <code class="docutils literal notranslate"><span class="pre">fun</span></code>. (Passed to <a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code></a>
automatically)</p>
</dd>
<dt>hess, hessp<span class="classifier">callable, optional</span></dt><dd><p>Hessian (matrix of second-order derivatives) of objective function
or Hessian of objective function times an arbitrary vector p.
Only for Newton-CG, dogleg, trust-ncg. Only one of <code class="docutils literal notranslate"><span class="pre">hessp</span></code> or
<code class="docutils literal notranslate"><span class="pre">hess</span></code> needs to be given. If <code class="docutils literal notranslate"><span class="pre">hess</span></code> is provided, then
<code class="docutils literal notranslate"><span class="pre">hessp</span></code> will be ignored. If neither <code class="docutils literal notranslate"><span class="pre">hess</span></code> nor <code class="docutils literal notranslate"><span class="pre">hessp</span></code> is
provided, then the Hessian product will be approximated using
finite differences on <code class="docutils literal notranslate"><span class="pre">jac</span></code>. <code class="docutils literal notranslate"><span class="pre">hessp</span></code> must compute the Hessian
times an arbitrary vector. (Passed to <a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code></a>
automatically)</p>
</dd>
</dl>
<p>Algorithm settings:</p>
<dl class="simple">
<dt>minimize_every_iter<span class="classifier">bool</span></dt><dd><p>If True then promising global sampling points will be passed to a
local minimization routine every iteration. If True then only the
final minimizer pool will be run. Defaults to True.</p>
</dd>
<dt>local_iter<span class="classifier">int</span></dt><dd><p>Only evaluate a few of the best minimizer pool candidates every
iteration. If False all potential points are passed to the local
minimization routine.</p>
</dd>
<dt>infty_constraints<span class="classifier">bool</span></dt><dd><p>If True then any sampling points generated which are outside will
the feasible domain will be saved and given an objective function
value of <code class="docutils literal notranslate"><span class="pre">inf</span></code>. If False then these points will be discarded.
Using this functionality could lead to higher performance with
respect to function evaluations before the global minimum is found,
specifying False will use less memory at the cost of a slight
decrease in performance. Defaults to True.</p>
</dd>
</dl>
<p>Feedback:</p>
<dl class="simple">
<dt>disp<span class="classifier">bool (L)</span></dt><dd><p>Set to True to print convergence messages.</p>
</dd>
</dl>
</dd>
<dt><strong>sampling_method</strong><span class="classifier">str or function, optional</span></dt><dd><p>Current built in sampling method options are <code class="docutils literal notranslate"><span class="pre">halton</span></code>, <code class="docutils literal notranslate"><span class="pre">sobol</span></code> and
<code class="docutils literal notranslate"><span class="pre">simplicial</span></code>. The default <code class="docutils literal notranslate"><span class="pre">simplicial</span></code> provides
the theoretical guarantee of convergence to the global minimum in
finite time. <code class="docutils literal notranslate"><span class="pre">halton</span></code> and <code class="docutils literal notranslate"><span class="pre">sobol</span></code> method are faster in terms of
sampling point generation at the cost of the loss of
guaranteed convergence. It is more appropriate for most “easier”
problems where the convergence is relatively fast.
User defined sampling functions must accept two arguments of <code class="docutils literal notranslate"><span class="pre">n</span></code>
sampling points of dimension <code class="docutils literal notranslate"><span class="pre">dim</span></code> per call and output an array of
sampling points with shape <em class="xref py py-obj">n x dim</em>.</p>
</dd>
<dt><strong>workers</strong><span class="classifier">int or map-like callable, optional</span></dt><dd><p>Sample and run the local serial minimizations in parallel.
Supply -1 to use all available CPU cores, or an int to use
that many Processes (uses <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#module-multiprocessing" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiprocessing.Pool</span></code></a>).</p>
<p>Alternatively supply a map-like callable, such as
<em class="xref py py-obj">multiprocessing.Pool.map</em> for parallel evaluation.
This evaluation is carried out as <code class="docutils literal notranslate"><span class="pre">workers(func,</span> <span class="pre">iterable)</span></code>.
Requires that <em class="xref py py-obj">func</em> be pickleable.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.11.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>res</strong><span class="classifier">OptimizeResult</span></dt><dd><p>The optimization result represented as a <a class="reference internal" href="scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult" title="scipy.optimize.OptimizeResult"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizeResult</span></code></a> object.
Important attributes are:
<code class="docutils literal notranslate"><span class="pre">x</span></code> the solution array corresponding to the global minimum,
<code class="docutils literal notranslate"><span class="pre">fun</span></code> the function output at the global solution,
<code class="docutils literal notranslate"><span class="pre">xl</span></code> an ordered list of local minima solutions,
<code class="docutils literal notranslate"><span class="pre">funl</span></code> the function output at the corresponding local solutions,
<code class="docutils literal notranslate"><span class="pre">success</span></code> a Boolean flag indicating if the optimizer exited
successfully,
<code class="docutils literal notranslate"><span class="pre">message</span></code> which describes the cause of the termination,
<code class="docutils literal notranslate"><span class="pre">nfev</span></code> the total number of objective function evaluations including
the sampling calls,
<code class="docutils literal notranslate"><span class="pre">nlfev</span></code> the total number of objective function evaluations
culminating from all local search optimizations,
<code class="docutils literal notranslate"><span class="pre">nit</span></code> number of iterations performed by the global routine.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Global optimization using simplicial homology global optimization <a class="reference internal" href="#rb2e152d227b3-1" id="id2">[1]</a>.
Appropriate for solving general purpose NLP and blackbox optimization
problems to global optimality (low-dimensional problems).</p>
<p>In general, the optimization problems are of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">minimize</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">subject</span> <span class="n">to</span>

<span class="n">g_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">m</span>
<span class="n">h_j</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">p</span>
</pre></div>
</div>
<p>where x is a vector of one or more variables. <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> is the objective
function <code class="docutils literal notranslate"><span class="pre">R^n</span> <span class="pre">-&gt;</span> <span class="pre">R</span></code>, <code class="docutils literal notranslate"><span class="pre">g_i(x)</span></code> are the inequality constraints, and
<code class="docutils literal notranslate"><span class="pre">h_j(x)</span></code> are the equality constraints.</p>
<p>Optionally, the lower and upper bounds for each element in x can also be
specified using the <em class="xref py py-obj">bounds</em> argument.</p>
<p>While most of the theoretical advantages of SHGO are only proven for when
<code class="docutils literal notranslate"><span class="pre">f(x)</span></code> is a Lipschitz smooth function, the algorithm is also proven to
converge to the global optimum for the more general case where <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> is
non-continuous, non-convex and non-smooth, if the default sampling method
is used <a class="reference internal" href="#rb2e152d227b3-1" id="id3">[1]</a>.</p>
<p>The local search method may be specified using the <code class="docutils literal notranslate"><span class="pre">minimizer_kwargs</span></code>
parameter which is passed on to <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. By default,
the <code class="docutils literal notranslate"><span class="pre">SLSQP</span></code> method is used. In general, it is recommended to use the
<code class="docutils literal notranslate"><span class="pre">SLSQP</span></code>, <code class="docutils literal notranslate"><span class="pre">COBYLA</span></code>, or <code class="docutils literal notranslate"><span class="pre">COBYQA</span></code> local minimization if inequality
constraints are defined for the problem since the other methods do not use
constraints.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">halton</span></code> and <code class="docutils literal notranslate"><span class="pre">sobol</span></code> method points are generated using
<a class="reference internal" href="../stats.qmc.html#module-scipy.stats.qmc" title="scipy.stats.qmc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.qmc</span></code></a>. Any other QMC method could be used.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rb2e152d227b3-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>Endres, SC, Sandrock, C, Focke, WW (2018) “A simplicial homology
algorithm for lipschitz optimisation”, Journal of Global
Optimization.</p>
</div>
<div class="citation" id="rb2e152d227b3-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Joe, SW and Kuo, FY (2008) “Constructing Sobol’ sequences with
better  two-dimensional projections”, SIAM J. Sci. Comput. 30,
2635-2654.</p>
</div>
<div class="citation" id="rb2e152d227b3-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id10">1</a>,<a role="doc-backlink" href="#id11">2</a>)</span>
<p>Hock, W and Schittkowski, K (1981) “Test examples for nonlinear
programming codes”, Lecture Notes in Economics and Mathematical
Systems, 187. Springer-Verlag, New York.
<a class="reference external" href="http://www.ai7.uni-bayreuth.de/test_problem_coll.pdf">http://www.ai7.uni-bayreuth.de/test_problem_coll.pdf</a></p>
</div>
<div class="citation" id="rb2e152d227b3-4" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">4</a><span class="fn-bracket">]</span></span>
<p>Wales, DJ (2015) “Perspective: Insight into reaction coordinates and
dynamics from the potential energy landscape”,
Journal of Chemical Physics, 142(13), 2015.</p>
</div>
<div class="citation" id="rb2e152d227b3-5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">5</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/optimize.html#constrained-minimization-of-multivariate-scalar-functions-minimize">https://docs.scipy.org/doc/scipy/tutorial/optimize.html#constrained-minimization-of-multivariate-scalar-functions-minimize</a></p>
</div>
</div>
<p class="rubric">Examples</p>
<div class="try_examples_outer_container docutils container" id="883670bf-8f5b-468e-b91a-fb0c9870276c">
<div class="try_examples_button_container"><button class="try_examples_button" onclick="window.tryExamplesShowIframe('883670bf-8f5b-468e-b91a-fb0c9870276c','7c6cea7b-3436-4119-8000-5fdd9b009a3f','5c3d026b-5e47-4d41-9240-12269108bce7','../../lite/tree/../notebooks/index.html?path=686ae0a5_319a_4402_90ff_8b74743ba39e.ipynb','None')">Try it in your browser!</button></div><div class="try_examples_content docutils container">
<p>First consider the problem of minimizing the Rosenbrock function, <a class="reference internal" href="scipy.optimize.rosen.html#scipy.optimize.rosen" title="scipy.optimize.rosen"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rosen</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">rosen</span><span class="p">,</span> <span class="n">shgo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="go">(array([1., 1., 1., 1., 1.]), 2.920392374190081e-18)</span>
</pre></div>
</div>
<p>Note that bounds determine the dimensionality of the objective
function and is therefore a required input, however you can specify
empty bounds using <code class="docutils literal notranslate"><span class="pre">None</span></code> or objects like <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> which will be
converted to large float numbers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">rosen</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">x</span>
<span class="go">array([0.99999851, 0.99999704, 0.99999411, 0.9999882 ])</span>
</pre></div>
</div>
<p>Next, we consider the Eggholder function, a problem with several local
minima and one global minimum. We will demonstrate the use of arguments and
the capabilities of <a class="reference internal" href="#scipy.optimize.shgo" title="scipy.optimize.shgo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shgo</span></code></a>.
(<a class="reference external" href="https://en.wikipedia.org/wiki/Test_functions_for_optimization">https://en.wikipedia.org/wiki/Test_functions_for_optimization</a>)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">eggholder</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">47.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">47.0</span><span class="p">))))</span>
<span class="gp">... </span>            <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">47.0</span><span class="p">))))</span>
<span class="gp">... </span>            <span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)]</span>
</pre></div>
</div>
<p><a class="reference internal" href="#scipy.optimize.shgo" title="scipy.optimize.shgo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shgo</span></code></a> has built-in low discrepancy sampling sequences. First, we will
input 64 initial sampling points of the <em>Sobol’</em> sequence:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">eggholder</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">sampling_method</span><span class="o">=</span><span class="s1">&#39;sobol&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
<span class="go">(array([512.        , 404.23180824]), -959.6406627208397)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#scipy.optimize.shgo" title="scipy.optimize.shgo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shgo</span></code></a> also has a return for any other local minima that was found, these
can be called using:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">xl</span>
<span class="go">array([[ 512.        ,  404.23180824],</span>
<span class="go">       [ 283.0759062 , -487.12565635],</span>
<span class="go">       [-294.66820039, -462.01964031],</span>
<span class="go">       [-105.87688911,  423.15323845],</span>
<span class="go">       [-242.97926   ,  274.38030925],</span>
<span class="go">       [-506.25823477,    6.3131022 ],</span>
<span class="go">       [-408.71980731, -156.10116949],</span>
<span class="go">       [ 150.23207937,  301.31376595],</span>
<span class="go">       [  91.00920901, -391.283763  ],</span>
<span class="go">       [ 202.89662724, -269.38043241],</span>
<span class="go">       [ 361.66623976, -106.96493868],</span>
<span class="go">       [-219.40612786, -244.06020508]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">funl</span>
<span class="go">array([-959.64066272, -718.16745962, -704.80659592, -565.99778097,</span>
<span class="go">       -559.78685655, -557.36868733, -507.87385942, -493.9605115 ,</span>
<span class="go">       -426.48799655, -421.15571437, -419.31194957, -410.98477763])</span>
</pre></div>
</div>
<p>These results are useful in applications where there are many global minima
and the values of other global minima are desired or where the local minima
can provide insight into the system (for example morphologies
in physical chemistry <a class="reference internal" href="#rb2e152d227b3-4" id="id9">[4]</a>).</p>
<p>If we want to find a larger number of local minima, we can increase the
number of sampling points or the number of iterations. We’ll increase the
number of sampling points to 64 and the number of iterations from the
default of 1 to 3. Using <code class="docutils literal notranslate"><span class="pre">simplicial</span></code> this would have given us
64 x 3 = 192 initial sampling points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result_2</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">eggholder</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">bounds</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">iters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling_method</span><span class="o">=</span><span class="s1">&#39;sobol&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">xl</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_2</span><span class="o">.</span><span class="n">xl</span><span class="p">)</span>
<span class="go">(12, 23)</span>
</pre></div>
</div>
<p>Note the difference between, e.g., <code class="docutils literal notranslate"><span class="pre">n=192,</span> <span class="pre">iters=1</span></code> and <code class="docutils literal notranslate"><span class="pre">n=64,</span>
<span class="pre">iters=3</span></code>.
In the first case the promising points contained in the minimiser pool
are processed only once. In the latter case it is processed every 64
sampling points for a total of 3 times.</p>
<p>To demonstrate solving problems with non-linear constraints consider the
following example from Hock and Schittkowski problem 73 (cattle-feed)
<a class="reference internal" href="#rb2e152d227b3-3" id="id10">[3]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">minimize</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="mf">24.55</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">+</span> <span class="mf">26.75</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">+</span> <span class="mi">39</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">+</span> <span class="mf">40.50</span> <span class="o">*</span> <span class="n">x_4</span>

<span class="n">subject</span> <span class="n">to</span><span class="p">:</span> <span class="mf">2.3</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">+</span> <span class="mf">5.6</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">+</span> <span class="mf">11.1</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">+</span> <span class="mf">1.3</span> <span class="o">*</span> <span class="n">x_4</span> <span class="o">-</span> <span class="mi">5</span>    <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>

            <span class="mi">12</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">+</span> <span class="mf">11.9</span> <span class="o">*</span> <span class="n">x_2</span> <span class="o">+</span> <span class="mf">41.8</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">+</span> <span class="mf">52.1</span> <span class="o">*</span> <span class="n">x_4</span> <span class="o">-</span> <span class="mi">21</span>
                <span class="o">-</span><span class="mf">1.645</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">0.28</span> <span class="o">*</span> <span class="n">x_1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.19</span> <span class="o">*</span> <span class="n">x_2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                              <span class="mf">20.5</span> <span class="o">*</span> <span class="n">x_3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.62</span> <span class="o">*</span> <span class="n">x_4</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>      <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>

            <span class="n">x_1</span> <span class="o">+</span> <span class="n">x_2</span> <span class="o">+</span> <span class="n">x_3</span> <span class="o">+</span> <span class="n">x_4</span> <span class="o">-</span> <span class="mi">1</span>                             <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>

            <span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">x_i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">i</span>
</pre></div>
</div>
<p>The approximate answer given in <a class="reference internal" href="#rb2e152d227b3-3" id="id11">[3]</a> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">([</span><span class="mf">0.6355216</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12e-11</span><span class="p">,</span> <span class="mf">0.3127019</span><span class="p">,</span> <span class="mf">0.05177655</span><span class="p">])</span> <span class="o">=</span> <span class="mf">29.894378</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># (cattle-feed)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">24.55</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">26.75</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">39</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">40.50</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">g1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">2.3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">5.6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">11.1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span>  <span class="c1"># &gt;=0</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">g2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">11.9</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mf">41.8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">52.1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">21</span>
<span class="gp">... </span>            <span class="o">-</span> <span class="mf">1.645</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.28</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.19</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>                            <span class="o">+</span> <span class="mf">20.5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.62</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>            <span class="p">)</span> <span class="c1"># &gt;=0</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">h1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># == 0</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cons</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">g1</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">g2</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">h1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),]</span><span class="o">*</span><span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">shgo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go"> message: Optimization terminated successfully.</span>
<span class="go"> success: True</span>
<span class="go">     fun: 29.894378159142136</span>
<span class="go">    funl: [ 2.989e+01]</span>
<span class="go">       x: [ 6.355e-01  1.137e-13  3.127e-01  5.178e-02] # may vary</span>
<span class="go">      xl: [[ 6.355e-01  1.137e-13  3.127e-01  5.178e-02]] # may vary</span>
<span class="go">     nit: 1</span>
<span class="go">    nfev: 142 # may vary</span>
<span class="go">   nlfev: 35 # may vary</span>
<span class="go">   nljev: 5</span>
<span class="go">   nlhev: 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g1</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">g2</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">h1</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-5.062616992290714e-14, -2.9594104944408173e-12, 0.0)</span>
</pre></div>
</div>
</div>
</div>
<div id="5c3d026b-5e47-4d41-9240-12269108bce7" class="try_examples_outer_iframe  hidden"><div class="try_examples_button_container"><button class="try_examples_button" onclick="window.tryExamplesHideIframe('883670bf-8f5b-468e-b91a-fb0c9870276c','5c3d026b-5e47-4d41-9240-12269108bce7')">Go Back</button><button class="try_examples_button" onclick="window.openInNewTab('883670bf-8f5b-468e-b91a-fb0c9870276c','5c3d026b-5e47-4d41-9240-12269108bce7')">Open In Tab</button></div><div id="7c6cea7b-3436-4119-8000-5fdd9b009a3f" class="jupyterlite_sphinx_iframe_container"></div></div><script>document.addEventListener("DOMContentLoaded", function() {window.loadTryExamplesConfig("../../try_examples.json");});</script></dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="scipy.optimize.differential_evolution.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">differential_evolution</p>
      </div>
    </a>
    <a class="right-next"
       href="scipy.optimize.dual_annealing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">dual_annealing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy.optimize.shgo"><code class="docutils literal notranslate"><span class="pre">shgo</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2008-2024, The SciPy community.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>