
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>scipy.stats.page_trend_test &#8212; SciPy v1.7.0.dev0+1036.4ec6f29 Manual</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="../../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="scipy.stats.ansari" href="scipy.stats.ansari.html" />
    <link rel="prev" title="scipy.stats.jarque_bera" href="scipy.stats.jarque_bera.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/scipyshiny_small.png" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorial/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dev/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/scipy/scipy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.html">
   Clustering package (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.vq.html">
   K-means clustering and vector quantization (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster.vq
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.hierarchy.html">
   Hierarchical clustering (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster.hierarchy
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../constants.html">
   Constants (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.constants
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fft.html">
   Discrete Fourier transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fft
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fftpack.html">
   Legacy discrete Fourier transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fftpack
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../integrate.html">
   Integration and ODEs (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpolate.html">
   Interpolation (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.interpolate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../io.html">
   Input and output (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.io
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.html">
   Linear algebra (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.blas.html">
   Low-level BLAS functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.blas
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.lapack.html">
   Low-level LAPACK functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.lapack
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.cython_blas.html">
   BLAS Functions for Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.cython_lapack.html">
   LAPACK functions for Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.interpolative.html">
   Interpolative matrix decomposition (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.interpolative
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../misc.html">
   Miscellaneous routines (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.misc
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ndimage.html">
   Multidimensional image processing (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../odr.html">
   Orthogonal distance regression (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.odr
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.html">
   Optimization and root finding (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.optimize
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.nonlin.html">
   Nonlinear solvers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.cython_optimize.html">
   Cython optimize zeros API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../signal.html">
   Signal processing (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.signal
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.html">
   Sparse matrices (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.linalg.html">
   Sparse linear algebra (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.csgraph.html">
   Compressed sparse graph routines (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse.csgraph
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial.html">
   Spatial algorithms and data structures (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.spatial
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial.distance.html">
   Distance computations (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.spatial.distance
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../special.html">
   Special functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.special
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../stats.html">
   Statistical functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats._result_classes.html">
   Result classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.mstats.html">
   Statistical functions for masked arrays (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.mstats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.qmc.html">
   Quasi-Monte Carlo submodule (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.qmc
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ccallback.html">
   Low-level callback functions
  </a>
 </li>
</ul>

    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="scipy-stats-page-trend-test">
<h1>scipy.stats.page_trend_test<a class="headerlink" href="#scipy-stats-page-trend-test" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="scipy.stats.page_trend_test">
<span class="sig-prename descclassname"><span class="pre">scipy.stats.</span></span><span class="sig-name descname"><span class="pre">page_trend_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/master/scipy/stats/_page_trend_test.py#L13-L361"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scipy.stats.page_trend_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Page’s Test, a measure of trend in observations between treatments.</p>
<p>Page’s Test (also known as Page’s <span class="math notranslate nohighlight">\(L\)</span> test) is useful when:</p>
<ul class="simple">
<li><p>there are <span class="math notranslate nohighlight">\(n \geq 3\)</span> treatments,</p></li>
<li><p><span class="math notranslate nohighlight">\(m \geq 2\)</span> subjects are observed for each treatment, and</p></li>
<li><p>the observations are hypothesized to have a particular order.</p></li>
</ul>
<p>Specifically, the test considers the null hypothesis that</p>
<div class="math notranslate nohighlight">
\[m_1 = m_2 = m_3 \cdots = m_n,\]</div>
<p>where <span class="math notranslate nohighlight">\(m_j\)</span> is the mean of the observed quantity under treatment
<span class="math notranslate nohighlight">\(j\)</span>, against the alternative hypothesis that</p>
<div class="math notranslate nohighlight">
\[m_1 \leq m_2 \leq m_3 \leq \cdots \leq m_n,\]</div>
<p>where at least one inequality is strict.</p>
<p>As noted by <a class="reference internal" href="#rb7ca5e705efa-4" id="id1">[4]</a>, Page’s <span class="math notranslate nohighlight">\(L\)</span> test has greater statistical power than
the Friedman test against the alternative that there is a difference in
trend, as Friedman’s test only considers a difference in the means of the
observations without considering their order. Whereas Spearman <span class="math notranslate nohighlight">\(\rho\)</span>
considers the correlation between the ranked observations of two variables
(e.g. the airspeed velocity of a swallow vs. the weight of the coconut it
carries), Page’s <span class="math notranslate nohighlight">\(L\)</span> is concerned with a trend in an observation
(e.g. the airspeed velocity of a swallow) across several distinct
treatments (e.g. carrying each of five coconuts of different weight) even
as the observation is repeated with multiple subjects (e.g. one European
swallow and one African swallow).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">array-like</span></dt><dd><p>A <span class="math notranslate nohighlight">\(m \times n\)</span> array; the element in row <span class="math notranslate nohighlight">\(i\)</span> and
column <span class="math notranslate nohighlight">\(j\)</span> is the observation corresponding with subject
<span class="math notranslate nohighlight">\(i\)</span> and treatment <span class="math notranslate nohighlight">\(j\)</span>. By default, the columns are
assumed to be arranged in order of increasing predicted mean.</p>
</dd>
<dt><strong>ranked</strong><span class="classifier">boolean, optional</span></dt><dd><p>By default, <em class="xref py py-obj">data</em> is assumed to be observations rather than ranks;
it will be ranked with <a class="reference internal" href="scipy.stats.rankdata.html#scipy.stats.rankdata" title="scipy.stats.rankdata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.rankdata</span></code></a> along <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>. If
<em class="xref py py-obj">data</em> is provided in the form of ranks, pass argument <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><strong>predicted_ranks</strong><span class="classifier">array-like, optional</span></dt><dd><p>The predicted ranks of the column means. If not specified,
the columns are assumed to be arranged in order of increasing
predicted mean, so the default <em class="xref py py-obj">predicted_ranks</em> are
<span class="math notranslate nohighlight">\([1, 2, \dots, n-1, n]\)</span>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{‘auto’, ‘asymptotic’, ‘exact’}, optional</span></dt><dd><p>Selects the method used to calculate the <em>p</em>-value. The following
options are available.</p>
<ul class="simple">
<li><p>‘auto’: selects between ‘exact’ and ‘asymptotic’ to
achieve reasonably accurate results in reasonable time (default)</p></li>
<li><p>‘asymptotic’: compares the standardized test statistic against
the normal distribution</p></li>
<li><p>‘exact’: computes the exact <em>p</em>-value by comparing the observed
<span class="math notranslate nohighlight">\(L\)</span> statistic against those realized by all possible
permutations of ranks (under the null hypothesis that each
permutation is equally likely)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>res</strong><span class="classifier">PageTrendTestResult</span></dt><dd><p>An object containing attributes:</p>
<dl class="simple">
<dt>statistic<span class="classifier">float</span></dt><dd><p>Page’s <span class="math notranslate nohighlight">\(L\)</span> test statistic.</p>
</dd>
<dt>pvalue<span class="classifier">float</span></dt><dd><p>The associated <em>p</em>-value</p>
</dd>
<dt>method<span class="classifier">{‘asymptotic’, ‘exact’}</span></dt><dd><p>The method used to compute the <em>p</em>-value</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="scipy.stats.rankdata.html#scipy.stats.rankdata" title="scipy.stats.rankdata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rankdata</span></code></a>, <a class="reference internal" href="scipy.stats.friedmanchisquare.html#scipy.stats.friedmanchisquare" title="scipy.stats.friedmanchisquare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">friedmanchisquare</span></code></a>, <a class="reference internal" href="scipy.stats.spearmanr.html#scipy.stats.spearmanr" title="scipy.stats.spearmanr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spearmanr</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>As noted in <a class="reference internal" href="#rb7ca5e705efa-1" id="id2">[1]</a>, “the <span class="math notranslate nohighlight">\(n\)</span> ‘treatments’ could just as well represent
<span class="math notranslate nohighlight">\(n\)</span> objects or events or performances or persons or trials ranked.”
Similarly, the <span class="math notranslate nohighlight">\(m\)</span> ‘subjects’ could equally stand for <span class="math notranslate nohighlight">\(m\)</span>
“groupings by ability or some other control variable, or judges doing
the ranking, or random replications of some other sort.”</p>
<p>The procedure for calculating the <span class="math notranslate nohighlight">\(L\)</span> statistic, adapted from
<a class="reference internal" href="#rb7ca5e705efa-1" id="id3">[1]</a>, is:</p>
<ol class="arabic simple">
<li><p>“Predetermine with careful logic the appropriate hypotheses
concerning the predicted ording of the experimental results.
If no reasonable basis for ordering any treatments is known, the
<span class="math notranslate nohighlight">\(L\)</span> test is not appropriate.”</p></li>
<li><p>“As in other experiments, determine at what level of confidence
you will reject the null hypothesis that there is no agreement of
experimental results with the monotonic hypothesis.”</p></li>
<li><p>“Cast the experimental material into a two-way table of <span class="math notranslate nohighlight">\(n\)</span>
columns (treatments, objects ranked, conditions) and <span class="math notranslate nohighlight">\(m\)</span>
rows (subjects, replication groups, levels of control variables).”</p></li>
<li><p>“When experimental observations are recorded, rank them across each
row”, e.g. <code class="docutils literal notranslate"><span class="pre">ranks</span> <span class="pre">=</span> <span class="pre">scipy.stats.rankdata(data,</span> <span class="pre">axis=1)</span></code>.</p></li>
<li><p>“Add the ranks in each column”, e.g.
<code class="docutils literal notranslate"><span class="pre">colsums</span> <span class="pre">=</span> <span class="pre">np.sum(ranks,</span> <span class="pre">axis=0)</span></code>.</p></li>
<li><p>“Multiply each sum of ranks by the predicted rank for that same
column”, e.g. <code class="docutils literal notranslate"><span class="pre">products</span> <span class="pre">=</span> <span class="pre">predicted_ranks</span> <span class="pre">*</span> <span class="pre">colsums</span></code>.</p></li>
<li><p>“Sum all such products”, e.g. <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">=</span> <span class="pre">products.sum()</span></code>.</p></li>
</ol>
<p><a class="reference internal" href="#rb7ca5e705efa-1" id="id4">[1]</a> continues by suggesting use of the standardized statistic</p>
<div class="math notranslate nohighlight">
\[\chi_L^2 = \frac{\left[12L-3mn(n+1)^2\right]^2}{mn^2(n^2-1)(n+1)}\]</div>
<p>“which is distributed approximately as chi-square with 1 degree of
freedom. The ordinary use of <span class="math notranslate nohighlight">\(\chi^2\)</span> tables would be
equivalent to a two-sided test of agreement. If a one-sided test
is desired, <em>as will almost always be the case</em>, the probability
discovered in the chi-square table should be <em>halved</em>.”</p>
<p>However, this standardized statistic does not distinguish between the
observed values being well correlated with the predicted ranks and being
_anti_-correlated with the predicted ranks. Instead, we follow <a class="reference internal" href="#rb7ca5e705efa-2" id="id5">[2]</a>
and calculate the standardized statistic</p>
<div class="math notranslate nohighlight">
\[\Lambda = \frac{L - E_0}{\sqrt{V_0}},\]</div>
<p>where <span class="math notranslate nohighlight">\(E_0 = \frac{1}{4} mn(n+1)^2\)</span> and
<span class="math notranslate nohighlight">\(V_0 = \frac{1}{144} mn^2(n+1)(n^2-1)\)</span>, “which is asymptotically
normal under the null hypothesis”.</p>
<p>The <em>p</em>-value for <code class="docutils literal notranslate"><span class="pre">method='exact'</span></code> is generated by comparing the observed
value of <span class="math notranslate nohighlight">\(L\)</span> against the <span class="math notranslate nohighlight">\(L\)</span> values generated for all
<span class="math notranslate nohighlight">\((n!)^m\)</span> possible permutations of ranks. The calculation is performed
using the recursive method of [5].</p>
<p>The <em>p</em>-values are not adjusted for the possibility of ties. When
ties are present, the reported  <code class="docutils literal notranslate"><span class="pre">'exact'</span></code> <em>p</em>-values may be somewhat
larger (i.e. more conservative) than the true <em>p</em>-value <a class="reference internal" href="#rb7ca5e705efa-2" id="id6">[2]</a>. The
<code class="docutils literal notranslate"><span class="pre">'asymptotic'`</span></code> <em>p</em>-values, however, tend to be smaller (i.e. less
conservative) than the <code class="docutils literal notranslate"><span class="pre">'exact'</span></code> <em>p</em>-values.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rb7ca5e705efa-1"><span class="brackets">1</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>,<a href="#id4">3</a>,<a href="#id14">4</a>)</span></dt>
<dd><p>Ellis Batten Page, “Ordered hypotheses for multiple treatments:
a significant test for linear ranks”, <em>Journal of the American
Statistical Association</em> 58(301), p. 216–230, 1963.</p>
</dd>
<dt class="label" id="rb7ca5e705efa-2"><span class="brackets">2</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>Markus Neuhauser, <em>Nonparametric Statistical Test: A computational
approach</em>, CRC Press, p. 150–152, 2012.</p>
</dd>
<dt class="label" id="rb7ca5e705efa-3"><span class="brackets">3</span><span class="fn-backref">(<a href="#id12">1</a>,<a href="#id13">2</a>)</span></dt>
<dd><p>Statext LLC, “Page’s L Trend Test - Easy Statistics”, <em>Statext -
Statistics Study</em>, <a class="reference external" href="https://www.statext.com/practice/PageTrendTest03.php">https://www.statext.com/practice/PageTrendTest03.php</a>,
Accessed July 12, 2020.</p>
</dd>
<dt class="label" id="rb7ca5e705efa-4"><span class="brackets"><a class="fn-backref" href="#id1">4</a></span></dt>
<dd><p>“Page’s Trend Test”, <em>Wikipedia</em>, WikimediaFoundation,
<a class="reference external" href="https://en.wikipedia.org/wiki/Page%27s_trend_test">https://en.wikipedia.org/wiki/Page%27s_trend_test</a>,
Accessed July 12, 2020.</p>
</dd>
<dt class="label" id="rb7ca5e705efa-5"><span class="brackets">5</span></dt>
<dd><p>Robert E. Odeh, “The exact distribution of Page’s L-statistic in
the two-way layout”, <em>Communications in Statistics - Simulation and
Computation</em>,  6(1), p. 49–61, 1977.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>We use the example from <a class="reference internal" href="#rb7ca5e705efa-3" id="id12">[3]</a>: 10 students are asked to rate three
teaching methods - tutorial, lecture, and seminar - on a scale of 1-5,
with 1 being the lowest and 5 being the highest. We have decided that
a confidence level of 99% is required to reject the null hypothesis in
favor of our alternative: that the seminar will have the highest ratings
and the tutorial will have the lowest. Initially, the data have been
tabulated with each row representing an individual student’s ratings of
the three methods in the following order: tutorial, lecture, seminar.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
<p>Because the tutorial is hypothesized to have the lowest ratings, the
column corresponding with tutorial rankings should be first; the seminar
is hypothesized to have the highest ratings, so its column should be last.
Since the columns are already arranged in this order of increasing
predicted mean, we can pass the table directly into <a class="reference internal" href="#scipy.stats.page_trend_test" title="scipy.stats.page_trend_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">page_trend_test</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">page_trend_test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">page_trend_test</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,</span>
<span class="go">                    method=&#39;exact&#39;)</span>
</pre></div>
</div>
<p>This <em>p</em>-value indicates that there is a 0.1819% chance that
the <span class="math notranslate nohighlight">\(L\)</span> statistic would reach such an extreme value under the null
hypothesis. Because 0.1819% is less than 1%, we have evidence to reject
the null hypothesis in favor of our alternative at a 99% confidence level.</p>
<p>The value of the <span class="math notranslate nohighlight">\(L\)</span> statistic is 133.5. To check this manually,
we rank the data such that high scores correspond with high ranks, settling
ties with an average rank:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">rankdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranks</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranks</span>
<span class="go">array([[1.5, 3. , 1.5],</span>
<span class="go">       [1.5, 1.5, 3. ],</span>
<span class="go">       [1.5, 1.5, 3. ],</span>
<span class="go">       [1. , 3. , 2. ],</span>
<span class="go">       [1.5, 3. , 1.5],</span>
<span class="go">       [1. , 2. , 3. ],</span>
<span class="go">       [1. , 2. , 3. ],</span>
<span class="go">       [1. , 2.5, 2.5],</span>
<span class="go">       [1. , 2. , 3. ],</span>
<span class="go">       [1. , 2. , 3. ]])</span>
</pre></div>
</div>
<p>We add the ranks within each column, multiply the sums by the
predicted ranks, and sum the products.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">ranks</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">predicted_ranks</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">statistic</span> <span class="o">==</span> <span class="n">L</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As presented in <a class="reference internal" href="#rb7ca5e705efa-3" id="id13">[3]</a>, the asymptotic approximation of the <em>p</em>-value is the
survival function of the normal distribution evaluated at the standardized
test statistic:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E0</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V0</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">144</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lambda</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">E0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">0.0012693433690751756</span>
</pre></div>
</div>
<p>This does not precisely match the <em>p</em>-value reported by <a class="reference internal" href="#scipy.stats.page_trend_test" title="scipy.stats.page_trend_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">page_trend_test</span></code></a>
above. The asymptotic distribution is not very accurate, nor conservative,
for <span class="math notranslate nohighlight">\(m \leq 12\)</span> and <span class="math notranslate nohighlight">\(n \leq 8\)</span>, so <a class="reference internal" href="#scipy.stats.page_trend_test" title="scipy.stats.page_trend_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">page_trend_test</span></code></a> chose to
use <code class="docutils literal notranslate"><span class="pre">method='exact'</span></code> based on the dimensions of the table and the
recommendations in Page’s original paper <a class="reference internal" href="#rb7ca5e705efa-1" id="id14">[1]</a>. To override
<a class="reference internal" href="#scipy.stats.page_trend_test" title="scipy.stats.page_trend_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">page_trend_test</span></code></a>’s choice, provide the <em class="xref py py-obj">method</em> argument.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">page_trend_test</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;asymptotic&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">PageTrendTestResult(statistic=133.5, pvalue=0.0012693433690751756,</span>
<span class="go">                    method=&#39;asymptotic&#39;)</span>
</pre></div>
</div>
<p>If the data are already ranked, we can pass in the <code class="docutils literal notranslate"><span class="pre">ranks</span></code> instead of
the <code class="docutils literal notranslate"><span class="pre">table</span></code> to save computation time.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">page_trend_test</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span>             <span class="c1"># ranks of data</span>
<span class="gp">... </span>                      <span class="n">ranked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>       <span class="c1"># data is already ranked</span>
<span class="gp">... </span>                      <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,</span>
<span class="go">                    method=&#39;exact&#39;)</span>
</pre></div>
</div>
<p>Suppose the raw data had been tabulated in an order different from the
order of predicted means, say lecture, seminar, tutorial.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">table</span><span class="p">)[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<p>Since the arrangement of this table is not consistent with the assumed
ordering, we can either rearrange the table or provide the
<em class="xref py py-obj">predicted_ranks</em>. Remembering that the lecture is predicted
to have the middle rank, the seminar the highest, and tutorial the lowest,
we pass:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">page_trend_test</span><span class="p">(</span><span class="n">table</span><span class="p">,</span>             <span class="c1"># data as originally tabulated</span>
<span class="gp">... </span>                      <span class="n">predicted_ranks</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># our predicted order</span>
<span class="gp">... </span>                      <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,</span>
<span class="go">                    method=&#39;exact&#39;)</span>
</pre></div>
</div>
</dd></dl>

</section>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="scipy.stats.jarque_bera.html" title="previous page">scipy.stats.jarque_bera</a>
    <a class='right-next' id="next-link" href="scipy.stats.ansari.html" title="next page">scipy.stats.ansari</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2008-2021, The SciPy community.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>