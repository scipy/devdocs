
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>scipy.stats.mannwhitneyu &#8212; SciPy v1.7.0.dev0+1036.4ec6f29 Manual</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="../../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="scipy.stats.tiecorrect" href="scipy.stats.tiecorrect.html" />
    <link rel="prev" title="scipy.stats.epps_singleton_2samp" href="scipy.stats.epps_singleton_2samp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/scipyshiny_small.png" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorial/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dev/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/scipy/scipy" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.html">
   Clustering package (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.vq.html">
   K-means clustering and vector quantization (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster.vq
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.hierarchy.html">
   Hierarchical clustering (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster.hierarchy
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../constants.html">
   Constants (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.constants
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fft.html">
   Discrete Fourier transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fft
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fftpack.html">
   Legacy discrete Fourier transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fftpack
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../integrate.html">
   Integration and ODEs (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpolate.html">
   Interpolation (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.interpolate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../io.html">
   Input and output (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.io
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.html">
   Linear algebra (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.blas.html">
   Low-level BLAS functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.blas
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.lapack.html">
   Low-level LAPACK functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.lapack
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.cython_blas.html">
   BLAS Functions for Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.cython_lapack.html">
   LAPACK functions for Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.interpolative.html">
   Interpolative matrix decomposition (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.interpolative
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../misc.html">
   Miscellaneous routines (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.misc
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ndimage.html">
   Multidimensional image processing (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../odr.html">
   Orthogonal distance regression (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.odr
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.html">
   Optimization and root finding (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.optimize
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.nonlin.html">
   Nonlinear solvers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.cython_optimize.html">
   Cython optimize zeros API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../signal.html">
   Signal processing (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.signal
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.html">
   Sparse matrices (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.linalg.html">
   Sparse linear algebra (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.csgraph.html">
   Compressed sparse graph routines (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse.csgraph
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial.html">
   Spatial algorithms and data structures (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.spatial
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial.distance.html">
   Distance computations (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.spatial.distance
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../special.html">
   Special functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.special
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../stats.html">
   Statistical functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats._result_classes.html">
   Result classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.mstats.html">
   Statistical functions for masked arrays (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.mstats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.qmc.html">
   Quasi-Monte Carlo submodule (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.qmc
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ccallback.html">
   Low-level callback functions
  </a>
 </li>
</ul>

    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="scipy-stats-mannwhitneyu">
<h1>scipy.stats.mannwhitneyu<a class="headerlink" href="#scipy-stats-mannwhitneyu" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="scipy.stats.mannwhitneyu">
<span class="sig-prename descclassname"><span class="pre">scipy.stats.</span></span><span class="sig-name descname"><span class="pre">mannwhitneyu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_continuity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'two-sided'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/master/scipy/stats/_mannwhitneyu.py#L181-L424"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scipy.stats.mannwhitneyu" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the Mann-Whitney U rank test on two independent samples.</p>
<p>The Mann-Whitney U test is a nonparametric test of the null hypothesis
that the distribution underlying sample <em class="xref py py-obj">x</em> is the same as the
distribution underlying sample <em class="xref py py-obj">y</em>. It is often used as a test of
of difference in location between distributions.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x, y</strong><span class="classifier">array-like</span></dt><dd><p>N-d arrays of samples. The arrays must be broadcastable except along
the dimension given by <em class="xref py py-obj">axis</em>.</p>
</dd>
<dt><strong>use_continuity</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether a continuity correction (1/2) should be applied.
Default is True when <em class="xref py py-obj">method</em> is <code class="docutils literal notranslate"><span class="pre">'asymptotic'</span></code>; has no effect
otherwise.</p>
</dd>
<dt><strong>alternative</strong><span class="classifier">{‘two-sided’, ‘less’, ‘greater’}, optional</span></dt><dd><p>Defines the alternative hypothesis. Default is ‘two-sided’.
Let <em>F(u)</em> and <em>G(u)</em> be the cumulative distribution functions of the
distributions underlying <em class="xref py py-obj">x</em> and <em class="xref py py-obj">y</em>, respectively. Then the following
alternative hypotheses are available:</p>
<ul class="simple">
<li><p>‘two-sided’: the distributions are not equal, i.e. <em>F(u) ≠ G(u)</em> for
at least one <em>u</em>.</p></li>
<li><p>‘less’: the distribution underlying <em class="xref py py-obj">x</em> is stochastically less
than the distribution underlying <em class="xref py py-obj">y</em>, i.e. <em>F(u) &gt; G(u)</em> for all <em>u</em>.</p></li>
<li><p>‘greater’: the distribution underlying <em class="xref py py-obj">x</em> is stochastically greater
than the distribution underlying <em class="xref py py-obj">y</em>, i.e. <em>F(u) &lt; G(u)</em> for all <em>u</em>.</p></li>
</ul>
<p>Under a more restrictive set of assumptions, the alternative hypotheses
can be expressed in terms of the locations of the distributions;
see [5] section 5.1.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis along which to perform the test. Default is 0.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{‘auto’, ‘asymptotic’, ‘exact’}, optional</span></dt><dd><p>Selects the method used to calculate the <em>p</em>-value.
Default is ‘auto’. The following options are available.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'asymptotic'</span></code>: compares the standardized test statistic
against the normal distribution, correcting for ties.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'exact'</span></code>: computes the exact <em>p</em>-value by comparing the observed
<span class="math notranslate nohighlight">\(U\)</span> statistic against the exact distribution of the <span class="math notranslate nohighlight">\(U\)</span>
statistic under the null hypothesis. No correction is made for ties.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'auto'</span></code>: chooses <code class="docutils literal notranslate"><span class="pre">'exact'</span></code> when the size of one of the samples
is less than 8 and there are no ties; chooses <code class="docutils literal notranslate"><span class="pre">'asymptotic'</span></code>
otherwise.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>res</strong><span class="classifier">MannwhitneyuResult</span></dt><dd><p>An object containing attributes:</p>
<dl class="simple">
<dt>statistic<span class="classifier">float</span></dt><dd><p>The Mann-Whitney U statistic corresponding with sample <em class="xref py py-obj">x</em>. See
Notes for the test statistic corresponding with sample <em class="xref py py-obj">y</em>.</p>
</dd>
<dt>pvalue<span class="classifier">float</span></dt><dd><p>The associated <em>p</em>-value for the chosen <em class="xref py py-obj">alternative</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="scipy.stats.wilcoxon.html#scipy.stats.wilcoxon" title="scipy.stats.wilcoxon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.wilcoxon</span></code></a>, <a class="reference internal" href="scipy.stats.ranksums.html#scipy.stats.ranksums" title="scipy.stats.ranksums"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.ranksums</span></code></a>, <a class="reference internal" href="scipy.stats.ttest_ind.html#scipy.stats.ttest_ind" title="scipy.stats.ttest_ind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.ttest_ind</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>If <code class="docutils literal notranslate"><span class="pre">U1</span></code> is the statistic corresponding with sample <em class="xref py py-obj">x</em>, then the
statistic corresponding with sample <em class="xref py py-obj">y</em> is
<em class="xref py py-obj">U2 = `x.shape[axis] * y.shape[axis] - U1`</em>.</p>
<p><a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a> is for independent samples. For related / paired samples,
consider <a class="reference internal" href="scipy.stats.wilcoxon.html#scipy.stats.wilcoxon" title="scipy.stats.wilcoxon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.wilcoxon</span></code></a>.</p>
<p><em class="xref py py-obj">method</em> <code class="docutils literal notranslate"><span class="pre">'exact'</span></code> is recommended when there are no ties and when either
sample size is less than 8 <a class="reference internal" href="#r31b0b1c0fec3-1" id="id1">[1]</a>. The implementation follows the recurrence
relation originally proposed in <a class="reference internal" href="#r31b0b1c0fec3-1" id="id2">[1]</a> as it is described in <a class="reference internal" href="#r31b0b1c0fec3-3" id="id3">[3]</a>.
Note that the exact method is <em>not</em> corrected for ties, but
<a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a> will not raise errors or warnings if there are ties in the
data.</p>
<p>The Mann-Whitney U test is a non-parametric version of the t-test for
independent samples. When the the means of samples from the populations
are normally distributed, consider <a class="reference internal" href="scipy.stats.ttest_ind.html#scipy.stats.ttest_ind" title="scipy.stats.ttest_ind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats.ttest_ind</span></code></a>.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r31b0b1c0fec3-1"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>H.B. Mann and D.R. Whitney, “On a test of whether one of two random
variables is stochastically larger than the other”, The Annals of
Mathematical Statistics, Vol. 18, pp. 50-60, 1947.</p>
</dd>
<dt class="label" id="r31b0b1c0fec3-2"><span class="brackets">2</span></dt>
<dd><p>Mann-Whitney U Test, Wikipedia,
<a class="reference external" href="http://en.wikipedia.org/wiki/Mann-Whitney_U_test">http://en.wikipedia.org/wiki/Mann-Whitney_U_test</a></p>
</dd>
<dt class="label" id="r31b0b1c0fec3-3"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>A. Di Bucchianico, “Combinatorics, computer algebra, and the
Wilcoxon-Mann-Whitney test”, Journal of Statistical Planning and
Inference, Vol. 79, pp. 349-364, 1999.</p>
</dd>
<dt class="label" id="r31b0b1c0fec3-4"><span class="brackets">4</span><span class="fn-backref">(<a href="#id9">1</a>,<a href="#id10">2</a>,<a href="#id11">3</a>,<a href="#id12">4</a>,<a href="#id13">5</a>,<a href="#id14">6</a>,<a href="#id15">7</a>)</span></dt>
<dd><p>Rosie Shier, “Statistics: 2.3 The Mann-Whitney U Test”, Mathematics
Learning Support Centre, 2004.</p>
</dd>
<dt class="label" id="r31b0b1c0fec3-5"><span class="brackets">5</span></dt>
<dd><p>Michael P. Fay and Michael A. Proschan. “Wilcoxon-Mann-Whitney
or t-test? On assumptions for hypothesis tests and multiple interpretations of decision rules.” Statistics surveys, Vol. 4, pp.
1-39, 2010. <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>We follow the example from <a class="reference internal" href="#r31b0b1c0fec3-4" id="id9">[4]</a>: nine randomly sampled young adults were
diagnosed with type II diabetes at the ages below.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">males</span> <span class="o">=</span> <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">24</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">females</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
<p>We use the Mann-Whitney U test to assess whether there is a statistically
significant difference in the diagnosis age of males and females.
The null hypothesis is that the distribution of male diagnosis ages is
the same as the distribution of female diagnosis ages. We decide
that a confidence level of 95% is required to reject the null hypothesis
in favor of the alternative that that the distributions are different.
Since the number of samples is very small and there are no ties in the
data, we can compare the observed test statistic against the <em>exact</em>
distribution of the test statistic under the null hypothesis.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">mannwhitneyu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U1</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">males</span><span class="p">,</span> <span class="n">females</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">U1</span><span class="p">)</span>
<span class="go">17.0</span>
</pre></div>
</div>
<p><a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a> always reports the statistic associated with the first
sample, which, in this case, is males. This agrees with <span class="math notranslate nohighlight">\(U_M = 17\)</span>
reported in <a class="reference internal" href="#r31b0b1c0fec3-4" id="id10">[4]</a>. The statistic associated with the second statistic
can be calculated:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">males</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">females</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">*</span><span class="n">ny</span> <span class="o">-</span> <span class="n">U1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">U2</span><span class="p">)</span>
<span class="go">3.0</span>
</pre></div>
</div>
<p>This agrees with <span class="math notranslate nohighlight">\(U_F = 3\)</span> reported in <a class="reference internal" href="#r31b0b1c0fec3-4" id="id11">[4]</a>. The two-sided
<em>p</em>-value can be calculated from either statistic, and the value produced
by <a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a> agrees with <span class="math notranslate nohighlight">\(p = 0.11\)</span> reported in <a class="reference internal" href="#r31b0b1c0fec3-4" id="id12">[4]</a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">0.1111111111111111</span>
</pre></div>
</div>
<p>The exact distribution of the test statistic is asymptotically normal, so
the example continues by comparing the exact <em>p</em>-value against the
<em>p</em>-value produced using the normal approximation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">pnorm</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">males</span><span class="p">,</span> <span class="n">females</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;asymptotic&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pnorm</span><span class="p">)</span>
<span class="go">0.11134688653314041</span>
</pre></div>
</div>
<p>Here <a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a>’s reported <em>p</em>-value appears to conflict with the
value <span class="math notranslate nohighlight">\(p = 0.09\)</span> given in <a class="reference internal" href="#r31b0b1c0fec3-4" id="id13">[4]</a>. The reason is that <a class="reference internal" href="#r31b0b1c0fec3-4" id="id14">[4]</a>
does not apply the continuity correction performed by <a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a>;
<a class="reference internal" href="#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mannwhitneyu</span></code></a> reduces the distance between the test statistic and the
mean <span class="math notranslate nohighlight">\(\mu = n_x n_y / 2\)</span> by 0.5 to correct for the fact that the
discrete statistic is being compared against a continuous distribution.
Here, the <span class="math notranslate nohighlight">\(U\)</span> statistic used is less than the mean, so we reduce
the distance by adding 0.5 in the numerator.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">+</span> <span class="n">ny</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">-</span> <span class="n">nx</span><span class="o">*</span><span class="n">ny</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nx</span><span class="o">*</span><span class="n">ny</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>  <span class="c1"># use CDF to get p-value from smaller statistic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">0.11134688653314041</span>
</pre></div>
</div>
<p>If desired, we can disable the continuity correction to get a result
that agrees with that reported in <a class="reference internal" href="#r31b0b1c0fec3-4" id="id15">[4]</a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">pnorm</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">males</span><span class="p">,</span> <span class="n">females</span><span class="p">,</span> <span class="n">use_continuity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;asymptotic&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pnorm</span><span class="p">)</span>
<span class="go">0.0864107329737</span>
</pre></div>
</div>
<p>Regardless of whether we perform an exact or asymptotic test, the
probability of the test statistic being as extreme or more extreme by
chance exceeds 5%, so we do not consider the results statistically
significant.</p>
<p>Suppose that, before seeing the data, we had hypothesized that females
would tend to be diagnosed at a younger age than males.
In that case, it would be natural to provide the female ages as the
first input, and we would have performed a one-sided test using
<code class="docutils literal notranslate"><span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">'less'</span></code>: females are diagnosed at an age that is
stochastically less than that of males.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">females</span><span class="p">,</span> <span class="n">males</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">MannwhitneyuResult(statistic=3.0, pvalue=0.05555555555555555)</span>
</pre></div>
</div>
<p>Again, the probability of getting a sufficiently low value of the
test statistic by chance under the null hypothesis is greater than 5%,
so we do not reject the null hypothesis in favor of our alternative.</p>
<p>If it is reasonable to assume that the means of samples from the
populations are normally distributed, we could have used a t-test to
perform the analysis.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_ind</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">females</span><span class="p">,</span> <span class="n">males</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">Ttest_indResult(statistic=-2.239334696520584, pvalue=0.030068441095757924)</span>
</pre></div>
</div>
<p>Under this assumption, the <em>p</em>-value would be low enough to reject the
null hypothesis in favor of the alternative.</p>
</dd></dl>

</section>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="scipy.stats.epps_singleton_2samp.html" title="previous page">scipy.stats.epps_singleton_2samp</a>
    <a class='right-next' id="next-link" href="scipy.stats.tiecorrect.html" title="next page">scipy.stats.tiecorrect</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2008-2021, The SciPy community.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>